map network drive Z
\\bio-martin-syn.bio.unc.edu\MartinLab
jmcgirr@ad.unc.edu

interactive longleaf
srun --pty /bin/bash

run a bunch of .sh scripts
for jobs in *.sh; do echo $jobs; sbatch $jobs; done


new GATK 
export PATH=$PATH:/proj/cmarlab/users/joe/gatk-4.0.10.1/gatk

##### RNAseq_2018 #####

#Use sbatch_submission_generator_round2.ipynb to get dedup.bam from fastq

#QC REPORT WITH MULTIQC (run in directory with files to analyze, will recognize .log files)
srun --pty /bin/bash
module load multiqc
multiqc . --ignore /pine/scr/j/m/jmcgirr/rna_2018/round_2/logs/errs/ --ignore /pine/scr/j/m/jmcgirr/rna_2018/round_2/logs/scripts/ --ignore /pine/scr/j/m/jmcgirr/rna_2018/round_2/logs/slurm_outs/ 

#FeatureCounts
featureCounts -p -a /proj/cmarlab/users/joe/Cyprinodon/my.gtf.geneid -B -C -G /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta -s 2 -T 4 -o #bams


#see sbatch_submission_rna_2018 jupyter notebook for pipline from fastq to dedup bam
 
trim_galore -q 20 --paired --illumina CAE1_R1_001.fastq CAE1_R2_001.fastq
star --runThreadN 4 --genomeDir /proj/cmarlab/users/joe/rna_2018/genome_dir --readFilesIn CAE1_R1_001_val_1.fq CAE1_R2_001_val_2.fq --outFileNamePrefix CAE1
samtools view -Sb CAE1Aligned.out.sam > CAE1.rna.bam
samtools sort CAE1.rna.bam -o CAE1.rna.sort.bam
samtools index CAE1.rna.sort.bam
java -jar picard.jar MarkDuplicates INPUT=CAE1.rna.sort.bam OUTPUT=CAE1.rna.sort.dedup.bam METRICS_FILE=CAE1.metrics.txt MAX_FILE_HANDLES=1000

sed 's/.rna.sort.bam//g' all_48hpf_and_8dpf_counts_my_gtf_geneid > all_48hpf_and_8dpf_counts_my_gtf_geneid_final

#blast
wget ftp://ftp.ncbi.nih.gov/genomes/Cyprinodon_variegatus/protein/
wget ftp://ftp.ncbi.nih.gov/refseq/D_rerio/mRNA_Prot/zebrafish.1.protein.faa.gz
makeblastdb -in cyprinodon_proteins.faa -dbtype prot
head -n 30 cyprinodon_proteins.faa > test_cyp_proteins
blastp -query test_cyp_proteins -db zebrafish.1.protein.faa -out cyprinodon_to_danio_one_way_best_hit.txt -evalue 1e-5 -outfmt 6 -max_target_seqs 1
blastp -query mouse.1.protein.faa -db cyprinodon_proteins.faa -out mus_to_cyprinodon_one_way_best_hit.txt -evalue 1e-5 -outfmt 6 -max_target_seqs 1
blastp -query zebrafish.1.protein.faa -db cyprinodon_proteins.faa -out danio_to_cyprinodon_one_way_best_hit.txt -evalue 1e-5 -outfmt 6 -max_target_seqs 1

sed 's/gi...............//' danio_to_cyprinodon_one_way_best_hit.txt  | sed 's/|//g' > test.txt
mv test.txt danio_to_cyprinodon_one_way_best_hit.txt 

1.	 qseqid	 query (e.g., gene) sequence id
2.	 sseqid	 subject (e.g., reference genome) sequence id
3.	 pident	 percentage of identical matches
4.	 length	 alignment length
5.	 mismatch	 number of mismatches
6.	 gapopen	 number of gap openings
7.	 qstart	 start of alignment in query
8.	 qend	 end of alignment in query
9.	 sstart	 start of alignment in subject
10.	 send	 end of alignment in subject
11.	 evalue	 expect value
12.	 bitscore	 bit score

#GFF to 12 colummn bed using GFFtools-GX-master
python gff_to_bed.py /proj/cmarlab/users/joe/Cyprinodon/ref_C_variegatus-1.0_scaffolds.gff3 > feature_table_12_column.bed

#Calculate TIN with RSeQC
tin.py -i /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/axmJ1.sort.bam -r /proj/cmarlab/users/joe/Cyprinodon/GFFtools-GX-master/test.bed

GEMMA
# -n specifies column in .fam file with relevant trait measure (2 = up jaw 3 = low jaw)
./gemma-0.98.1-linux-static -bfile 58_dna_maf_0.5_maxmiss_0.9_snps.recode.vcf.plink -w 50000000 -s 100000000 -n 2 -rpace 10000 -wpace 100000 -bslmm 1 -o gemma_up_jaw
./gemma-0.98.1-linux-static -bfile 58_dna_maf_0.5_maxmiss_0.9_snps.recode.vcf.plink -w 50000000 -s 100000000 -n 3 -rpace 10000 -wpace 100000 -bslmm 1 -o gemma_low_jaw

	
# make VCF for axm rna misexpression
cd /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/variants
bsub -q week "java -jar picard.jar AddOrReplaceReadGroups I=CPAE1.rna.sort.bam O=CPAE1.rna.RG.bam  RGLB=lib1 RGPL=illumina RGPU=unit1 RGSM=20"
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T SplitNCigarReads -R /proj/cmarlab/users/joe/axm_rna/tmp/Cyprinodon_NW.fasta -I LLMJ3.sort.RG.bam -o LLMJ3.sort.RG.split.bam -rf ReassignOneMappingQuality -RMQF 255 -RMQT 60 -U ALLOW_N_CIGAR_READS"
bsub -n 8 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar /proj/cmarlab/users/joe/AxM_high_cov_cross_trimmed_fastqs/GenomeAnalysisTK.jar -T SplitNCigarReads -drf DuplicateRead -rf ReassignOneMappingQuality -RMQF 255 -RMQT 60 -U ALLOW_N_CIGAR_READS -R /proj/cmarlab/users/joe/axm_rna/tmp/Cyprinodon_NW.fasta -I /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/17and8dpf/RG/axmJ6.rna.RG.bam -o /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/17and8dpf/RG/axmJ6.rna.RG.split.bam"
bsub -n 8 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar /proj/cmarlab/users/joe/AxM_high_cov_cross_trimmed_fastqs/GenomeAnalysisTK.jar -T HaplotypeCaller -drf DuplicateRead -R /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta -I /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/17and8dpf/RG/CXE3.rna.RG.split.bam  -dontUseSoftClippedBases -stand_call_conf 20.0 -nct 8 -o /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/variants/CXE3_raw_variants.g.vcf"
bsub -q week -M 50 "vcf-merge axmE1_raw_variants.g.vcf.gz axmE2_raw_variants.g.vcf.gz axmJ1_raw_variants.g.vcf.gz axmJ4_raw_variants.g.vcf.gz axmJ5_raw_variants.g.vcf.gz axmJ6_raw_variants.g.vcf.gz LLA-QTL_raw_variants_longleaf.g.vcf.gz LLM-QTL_raw_variants_longleaf.g.vcf.gz > qtl_parents_LLA_LLM_gDNA_and_LLAxLLM_F1_cDNA_raw_variants.vcf"
bsub -q week "java -jar /proj/cmarlab/users/joe/AxM_high_cov_cross_trimmed_fastqs/GenomeAnalysisTK.jar -T SelectVariants -U ALLOW_SEQ_DICT_INCOMPATIBILITY -R /proj/cmarlab/users/joe/axm_rna/tmp/Cyprinodon_NW.fasta -V 17dpf_8dpf_raw_variants.vcf -selectType SNP -o 17dpf_8dpf_raw_snps.vcf" 
bsub -q week java -jar /proj/cmarlab/users/joe/AxM_high_cov_cross_trimmed_fastqs/GenomeAnalysisTK.jar -T VariantFiltration -R /proj/cmarlab/users/joe/axm_rna/tmp/Cyprinodon_NW.fasta -V 17dpf_8dpf_raw_snps.vcf --filterExpression "QD < 2.0 || FS > 60.0 || MQ < 40.0 || MQRankSum < -12.5 || ReadPosRankSum < -8.0" --filterName "standard_snp_filter" -o 17dpf_8dpf_filtered_snps.vcf
bsub -q week "vcftools --vcf 17dpf_8dpf_filtered_snps.vcf --maf 0.05 --max-missing 0.9 --recode --out 17dpf_8dpf_maf_0.5_maxmiss_0.9_snps"
bcftools view -Ov -s axmJ4_raw_variants.g_20 /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/variants/17dpf_8dpf_maf_0.5_maxmiss_0.9_snps.recode.vcf > axmJ4_snps.vcf
bcftools reheader -s sample_name_20.txt /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/variants/indiv_vcfs/axmJ4_snps.vcf > test.vcf
bsub -q week -M 50 "java -jar /proj/cmarlab/users/joe/AxM_high_cov_cross_trimmed_fastqs/GenomeAnalysisTK.jar -T ReadBackedPhasing -R /proj/cmarlab/users/joe/axm_rna/tmp/Cyprinodon_NW.fasta -I /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/17and8dpf/RG/axmJ1.rna.RG.split.bam --variant /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/variants/indiv_vcfs/axmJ1_snps.vcf -o /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/variants/indiv_vcfs/axmJ1_phased.vcf --phaseQualityThresh 20.0"
bsub -q week "java -jar /proj/cmarlab/users/joe/AxM_high_cov_cross_trimmed_fastqs/GenomeAnalysisTK.jar -R /proj/cmarlab/users/joe/axm_rna/tmp/Cyprinodon_NW.fasta -T ASEReadCounter -U ALLOW_SEQ_DICT_INCOMPATIBILITY -o ./allele_counts/axmJ1_allele_counts.csv -I  /proj/cmarlab/users/joe/axm_rna/rna_bams/sorted_bams/17and8dpf/RG/axmJ1.rna.RG.split.bam -sites axmJ1_phased.vcf"           
bsub -q week java -jar /proj/cmarlab/users/joe/AxM_high_cov_cross_trimmed_fastqs/try_again/GenomeAnalysisTK.jar -R /proj/cmarlab/users/joe/axm_rna/tmp/Cyprinodon_NW.fasta -T VariantsToTable -V axmJ1_phased.vcf -F CHROM -F POS -GF GT -GF HP -o ./allele_counts/axmJ1_snp_table.txt

DNA from parents

mv HCJ7HDSXX_s1_1_GSLv5-8_i7_79-GSLv5-8_i5_18_SL347722.fastq.gz	CPF1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_79-GSLv5-8_i5_18_SL347722.fastq.gz	CPF1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_79-GSLv5-8_i5_18_SL347722.fastq.gz	CPF1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_79-GSLv5-8_i5_18_SL347722.fastq.gz	CPF1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_79-GSLv5-8_i5_18_SL347722.fastq.gz	CPF1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_79-GSLv5-8_i5_18_SL347722.fastq.gz	CPF1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_79-GSLv5-8_i5_18_SL347722.fastq	CPF1_r1_l4.fastq
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_79-GSLv5-8_i5_18_SL347722.fastq.gz	CPF1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_80-GSLv5-8_i5_17_SL347723.fastq.gz	OAF1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_80-GSLv5-8_i5_17_SL347723.fastq.gz	OAF1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_80-GSLv5-8_i5_17_SL347723.fastq.gz	OAF1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_80-GSLv5-8_i5_17_SL347723.fastq.gz	OAF1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_80-GSLv5-8_i5_17_SL347723.fastq.gz	OAF1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_80-GSLv5-8_i5_17_SL347723.fastq.gz	OAF1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_80-GSLv5-8_i5_17_SL347723.fastq.gz	OAF1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_80-GSLv5-8_i5_17_SL347723.fastq.gz	OAF1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_81-GSLv5-8_i5_16_SL347724.fastq.gz	CMM1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_81-GSLv5-8_i5_16_SL347724.fastq.gz	CMM1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_81-GSLv5-8_i5_16_SL347724.fastq.gz	CMM1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_81-GSLv5-8_i5_16_SL347724.fastq.gz	CMM1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_81-GSLv5-8_i5_16_SL347724.fastq.gz	CMM1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_81-GSLv5-8_i5_16_SL347724.fastq.gz	CMM1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_81-GSLv5-8_i5_16_SL347724.fastq.gz	CMM1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_81-GSLv5-8_i5_16_SL347724.fastq.gz	CMM1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_82-GSLv5-8_i5_15_SL347725.fastq.gz	OAM1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_82-GSLv5-8_i5_15_SL347725.fastq.gz	OAM1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_82-GSLv5-8_i5_15_SL347725.fastq.gz	OAM1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_82-GSLv5-8_i5_15_SL347725.fastq.gz	OAM1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_82-GSLv5-8_i5_15_SL347725.fastq.gz	OAM1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_82-GSLv5-8_i5_15_SL347725.fastq.gz	OAM1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_82-GSLv5-8_i5_15_SL347725.fastq.gz	OAM1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_82-GSLv5-8_i5_15_SL347725.fastq.gz	OAM1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_83-GSLv5-8_i5_14_SL347726.fastq.gz	CPM1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_83-GSLv5-8_i5_14_SL347726.fastq.gz	CPM1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_83-GSLv5-8_i5_14_SL347726.fastq.gz	CPM1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_83-GSLv5-8_i5_14_SL347726.fastq.gz	CPM1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_83-GSLv5-8_i5_14_SL347726.fastq.gz	CPM1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_83-GSLv5-8_i5_14_SL347726.fastq.gz	CPM1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_83-GSLv5-8_i5_14_SL347726.fastq.gz	CPM1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_83-GSLv5-8_i5_14_SL347726.fastq.gz	CPM1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_84-GSLv5-8_i5_13_SL347727.fastq.gz	OMF1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_84-GSLv5-8_i5_13_SL347727.fastq.gz	OMF1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_84-GSLv5-8_i5_13_SL347727.fastq.gz	OMF1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_84-GSLv5-8_i5_13_SL347727.fastq.gz	OMF1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_84-GSLv5-8_i5_13_SL347727.fastq.gz	OMF1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_84-GSLv5-8_i5_13_SL347727.fastq.gz	OMF1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_84-GSLv5-8_i5_13_SL347727.fastq.gz	OMF1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_84-GSLv5-8_i5_13_SL347727.fastq.gz	OMF1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_85-GSLv5-8_i5_12_SL347728.fastq.gz	OPM1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_85-GSLv5-8_i5_12_SL347728.fastq.gz	OPM1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_85-GSLv5-8_i5_12_SL347728.fastq.gz	OPM1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_85-GSLv5-8_i5_12_SL347728.fastq.gz	OPM1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_85-GSLv5-8_i5_12_SL347728.fastq.gz	OPM1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_85-GSLv5-8_i5_12_SL347728.fastq.gz	OPM1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_85-GSLv5-8_i5_12_SL347728.fastq.gz	OPM1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_85-GSLv5-8_i5_12_SL347728.fastq.gz	OPM1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_86-GSLv5-8_i5_11_SL347729.fastq.gz	CMF1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_86-GSLv5-8_i5_11_SL347729.fastq.gz	CMF1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_86-GSLv5-8_i5_11_SL347729.fastq.gz	CMF1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_86-GSLv5-8_i5_11_SL347729.fastq.gz	CMF1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_86-GSLv5-8_i5_11_SL347729.fastq.gz	CMF1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_86-GSLv5-8_i5_11_SL347729.fastq.gz	CMF1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_86-GSLv5-8_i5_11_SL347729.fastq.gz	CMF1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_86-GSLv5-8_i5_11_SL347729.fastq.gz	CMF1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_87-GSLv5-8_i5_10_SL347730.fastq.gz	OMM1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_87-GSLv5-8_i5_10_SL347730.fastq.gz	OMM1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_87-GSLv5-8_i5_10_SL347730.fastq.gz	OMM1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_87-GSLv5-8_i5_10_SL347730.fastq.gz	OMM1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_87-GSLv5-8_i5_10_SL347730.fastq.gz	OMM1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_87-GSLv5-8_i5_10_SL347730.fastq.gz	OMM1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_87-GSLv5-8_i5_10_SL347730.fastq.gz	OMM1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_87-GSLv5-8_i5_10_SL347730.fastq.gz	OMM1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_88-GSLv5-8_i5_09_SL347731.fastq.gz	CAM1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_88-GSLv5-8_i5_09_SL347731.fastq.gz	CAM1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_88-GSLv5-8_i5_09_SL347731.fastq.gz	CAM1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_88-GSLv5-8_i5_09_SL347731.fastq.gz	CAM1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_88-GSLv5-8_i5_09_SL347731.fastq.gz	CAM1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_88-GSLv5-8_i5_09_SL347731.fastq.gz	CAM1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_88-GSLv5-8_i5_09_SL347731.fastq.gz	CAM1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_88-GSLv5-8_i5_09_SL347731.fastq.gz	CAM1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_89-GSLv5-8_i5_08_SL347732.fastq.gz	CAM2_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_89-GSLv5-8_i5_08_SL347732.fastq.gz	CAM2_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_89-GSLv5-8_i5_08_SL347732.fastq.gz	CAM2_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_89-GSLv5-8_i5_08_SL347732.fastq.gz	CAM2_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_89-GSLv5-8_i5_08_SL347732.fastq.gz	CAM2_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_89-GSLv5-8_i5_08_SL347732.fastq.gz	CAM2_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_89-GSLv5-8_i5_08_SL347732.fastq.gz	CAM2_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_89-GSLv5-8_i5_08_SL347732.fastq.gz	CAM2_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_90-GSLv5-8_i5_07_SL347733.fastq.gz	OPF1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_90-GSLv5-8_i5_07_SL347733.fastq.gz	OPF1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_90-GSLv5-8_i5_07_SL347733.fastq.gz	OPF1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_90-GSLv5-8_i5_07_SL347733.fastq.gz	OPF1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_90-GSLv5-8_i5_07_SL347733.fastq.gz	OPF1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_90-GSLv5-8_i5_07_SL347733.fastq.gz	OPF1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_90-GSLv5-8_i5_07_SL347733.fastq.gz	OPF1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_90-GSLv5-8_i5_07_SL347733.fastq.gz	OPF1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_91-GSLv5-8_i5_06_SL347734.fastq.gz	NAF1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_91-GSLv5-8_i5_06_SL347734.fastq.gz	NAF1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_91-GSLv5-8_i5_06_SL347734.fastq.gz	NAF1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_91-GSLv5-8_i5_06_SL347734.fastq.gz	NAF1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_91-GSLv5-8_i5_06_SL347734.fastq.gz	NAF1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_91-GSLv5-8_i5_06_SL347734.fastq.gz	NAF1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_91-GSLv5-8_i5_06_SL347734.fastq.gz	NAF1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_91-GSLv5-8_i5_06_SL347734.fastq.gz	NAF1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_92-GSLv5-8_i5_05_SL347735.fastq.gz	CAF1_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_92-GSLv5-8_i5_05_SL347735.fastq.gz	CAF1_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_92-GSLv5-8_i5_05_SL347735.fastq.gz	CAF1_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_92-GSLv5-8_i5_05_SL347735.fastq.gz	CAF1_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_92-GSLv5-8_i5_05_SL347735.fastq.gz	CAF1_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_92-GSLv5-8_i5_05_SL347735.fastq.gz	CAF1_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_92-GSLv5-8_i5_05_SL347735.fastq.gz	CAF1_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_92-GSLv5-8_i5_05_SL347735.fastq.gz	CAF1_r2_l4.fastq.gz
mv HCJ7HDSXX_s1_1_GSLv5-8_i7_93-GSLv5-8_i5_04_SL347736.fastq.gz	CUNP_r1_l1.fastq.gz
mv HCJ7HDSXX_s1_2_GSLv5-8_i7_93-GSLv5-8_i5_04_SL347736.fastq.gz	CUNP_r2_l1.fastq.gz
mv HCJ7HDSXX_s2_1_GSLv5-8_i7_93-GSLv5-8_i5_04_SL347736.fastq.gz	CUNP_r1_l2.fastq.gz
mv HCJ7HDSXX_s2_2_GSLv5-8_i7_93-GSLv5-8_i5_04_SL347736.fastq.gz	CUNP_r2_l2.fastq.gz
mv HCJ7HDSXX_s3_1_GSLv5-8_i7_93-GSLv5-8_i5_04_SL347736.fastq.gz	CUNP_r1_l3.fastq.gz
mv HCJ7HDSXX_s3_2_GSLv5-8_i7_93-GSLv5-8_i5_04_SL347736.fastq.gz	CUNP_r2_l3.fastq.gz
mv HCJ7HDSXX_s4_1_GSLv5-8_i7_93-GSLv5-8_i5_04_SL347736.fastq.gz	CUNP_r1_l4.fastq.gz
mv HCJ7HDSXX_s4_2_GSLv5-8_i7_93-GSLv5-8_i5_04_SL347736.fastq.gz	CUNP_r2_l4.fastq.gz

bsub -q week "trim_galore -q 20 --paired --illumina CAF1_r1_l1.fastq CAF1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAF1_r1_l2.fastq CAF1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAF1_r1_l3.fastq CAF1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAF1_r1_l4.fastq CAF1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAM1_r1_l1.fastq CAM1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAM1_r1_l2.fastq CAM1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAM1_r1_l3.fastq CAM1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAM1_r1_l4.fastq CAM1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAM2_r1_l1.fastq CAM2_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAM2_r1_l2.fastq CAM2_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAM2_r1_l3.fastq CAM2_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CAM2_r1_l4.fastq CAM2_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CMF1_r1_l1.fastq CMF1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CMF1_r1_l2.fastq CMF1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CMF1_r1_l3.fastq CMF1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CMF1_r1_l4.fastq CMF1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CMM1_r1_l1.fastq CMM1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CMM1_r1_l2.fastq CMM1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CMM1_r1_l3.fastq CMM1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CMM1_r1_l4.fastq CMM1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPF1_r1_l1.fastq CPF1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPF1_r1_l2.fastq CPF1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPF1_r1_l3.fastq CPF1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPF1_r1_l4.fastq CPF1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPM1_r1_l1.fastq CPM1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPM1_r1_l2.fastq CPM1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPM1_r1_l3.fastq CPM1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPM1_r1_l4.fastq CPM1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CUNP_r1_l1.fastq CUNP_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CUNP_r1_l2.fastq CUNP_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CUNP_r1_l3.fastq CUNP_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CUNP_r1_l4.fastq CUNP_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina NAF1_r1_l1.fastq NAF1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina NAF1_r1_l2.fastq NAF1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina NAF1_r1_l3.fastq NAF1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina NAF1_r1_l4.fastq NAF1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OAF1_r1_l1.fastq OAF1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OAF1_r1_l2.fastq OAF1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OAF1_r1_l3.fastq OAF1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OAF1_r1_l4.fastq OAF1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OAM1_r1_l1.fastq OAM1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OAM1_r1_l2.fastq OAM1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OAM1_r1_l3.fastq OAM1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OAM1_r1_l4.fastq OAM1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OMF1_r1_l1.fastq OMF1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OMF1_r1_l2.fastq OMF1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OMF1_r1_l3.fastq OMF1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OMF1_r1_l4.fastq OMF1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OMM1_r1_l1.fastq OMM1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OMM1_r1_l2.fastq OMM1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OMM1_r1_l3.fastq OMM1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OMM1_r1_l4.fastq OMM1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OPF1_r1_l1.fastq OPF1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OPF1_r1_l2.fastq OPF1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OPF1_r1_l3.fastq OPF1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OPF1_r1_l4.fastq OPF1_r2_l4.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OPM1_r1_l1.fastq OPM1_r2_l1.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OPM1_r1_l2.fastq OPM1_r2_l2.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OPM1_r1_l3.fastq OPM1_r2_l3.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina OPM1_r1_l4.fastq OPM1_r2_l4.fastq"

bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAF1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAF1_r1_l1_val_1.fq CAF1_r2_l1_val_2.fq > CAF1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAF1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAF1_r1_l2_val_1.fq CAF1_r2_l2_val_2.fq > CAF1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAF1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAF1_r1_l3_val_1.fq CAF1_r2_l3_val_2.fq > CAF1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAF1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAF1_r1_l4_val_1.fq CAF1_r2_l4_val_2.fq > CAF1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAM1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAM1_r1_l1_val_1.fq CAM1_r2_l1_val_2.fq > CAM1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAM1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAM1_r1_l2_val_1.fq CAM1_r2_l2_val_2.fq > CAM1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAM1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAM1_r1_l3_val_1.fq CAM1_r2_l3_val_2.fq > CAM1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAM1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAM1_r1_l4_val_1.fq CAM1_r2_l4_val_2.fq > CAM1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAM2_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAM2_r1_l1_val_1.fq CAM2_r2_l1_val_2.fq > CAM2_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAM2_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAM2_r1_l2_val_1.fq CAM2_r2_l2_val_2.fq > CAM2_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAM2_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAM2_r1_l3_val_1.fq CAM2_r2_l3_val_2.fq > CAM2_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CAM2_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CAM2_r1_l4_val_1.fq CAM2_r2_l4_val_2.fq > CAM2_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CMF1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CMF1_r1_l1_val_1.fq CMF1_r2_l1_val_2.fq > CMF1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CMF1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CMF1_r1_l2_val_1.fq CMF1_r2_l2_val_2.fq > CMF1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CMF1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CMF1_r1_l3_val_1.fq CMF1_r2_l3_val_2.fq > CMF1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CMF1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CMF1_r1_l4_val_1.fq CMF1_r2_l4_val_2.fq > CMF1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CMM1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CMM1_r1_l1_val_1.fq CMM1_r2_l1_val_2.fq > CMM1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CMM1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CMM1_r1_l2_val_1.fq CMM1_r2_l2_val_2.fq > CMM1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CMM1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CMM1_r1_l3_val_1.fq CMM1_r2_l3_val_2.fq > CMM1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CMM1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CMM1_r1_l4_val_1.fq CMM1_r2_l4_val_2.fq > CMM1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CPF1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CPF1_r1_l1_val_1.fq CPF1_r2_l1_val_2.fq > CPF1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CPF1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CPF1_r1_l2_val_1.fq CPF1_r2_l2_val_2.fq > CPF1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CPF1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CPF1_r1_l3_val_1.fq CPF1_r2_l3_val_2.fq > CPF1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CPF1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CPF1_r1_l4_val_1.fq CPF1_r2_l4_val_2.fq > CPF1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CPM1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CPM1_r1_l1_val_1.fq CPM1_r2_l1_val_2.fq > CPM1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CPM1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CPM1_r1_l2_val_1.fq CPM1_r2_l2_val_2.fq > CPM1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CPM1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CPM1_r1_l3_val_1.fq CPM1_r2_l3_val_2.fq > CPM1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CPM1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CPM1_r1_l4_val_1.fq CPM1_r2_l4_val_2.fq > CPM1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CUNP_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CUNP_r1_l1_val_1.fq CUNP_r2_l1_val_2.fq > CUNP_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CUNP_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CUNP_r1_l2_val_1.fq CUNP_r2_l2_val_2.fq > CUNP_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CUNP_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CUNP_r1_l3_val_1.fq CUNP_r2_l3_val_2.fq > CUNP_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:CUNP_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta CUNP_r1_l4_val_1.fq CUNP_r2_l4_val_2.fq > CUNP_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:NAF1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta NAF1_r1_l1_val_1.fq NAF1_r2_l1_val_2.fq > NAF1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:NAF1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta NAF1_r1_l2_val_1.fq NAF1_r2_l2_val_2.fq > NAF1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:NAF1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta NAF1_r1_l3_val_1.fq NAF1_r2_l3_val_2.fq > NAF1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:NAF1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta NAF1_r1_l4_val_1.fq NAF1_r2_l4_val_2.fq > NAF1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OAF1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OAF1_r1_l1_val_1.fq OAF1_r2_l1_val_2.fq > OAF1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OAF1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OAF1_r1_l2_val_1.fq OAF1_r2_l2_val_2.fq > OAF1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OAF1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OAF1_r1_l3_val_1.fq OAF1_r2_l3_val_2.fq > OAF1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OAF1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OAF1_r1_l4_val_1.fq OAF1_r2_l4_val_2.fq > OAF1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OAM1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OAM1_r1_l1_val_1.fq OAM1_r2_l1_val_2.fq > OAM1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OAM1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OAM1_r1_l2_val_1.fq OAM1_r2_l2_val_2.fq > OAM1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OAM1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OAM1_r1_l3_val_1.fq OAM1_r2_l3_val_2.fq > OAM1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OAM1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OAM1_r1_l4_val_1.fq OAM1_r2_l4_val_2.fq > OAM1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OMF1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OMF1_r1_l1_val_1.fq OMF1_r2_l1_val_2.fq > OMF1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OMF1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OMF1_r1_l2_val_1.fq OMF1_r2_l2_val_2.fq > OMF1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OMF1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OMF1_r1_l3_val_1.fq OMF1_r2_l3_val_2.fq > OMF1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OMF1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OMF1_r1_l4_val_1.fq OMF1_r2_l4_val_2.fq > OMF1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OMM1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OMM1_r1_l1_val_1.fq OMM1_r2_l1_val_2.fq > OMM1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OMM1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OMM1_r1_l2_val_1.fq OMM1_r2_l2_val_2.fq > OMM1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OMM1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OMM1_r1_l3_val_1.fq OMM1_r2_l3_val_2.fq > OMM1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OMM1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OMM1_r1_l4_val_1.fq OMM1_r2_l4_val_2.fq > OMM1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OPF1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OPF1_r1_l1_val_1.fq OPF1_r2_l1_val_2.fq > OPF1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OPF1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OPF1_r1_l2_val_1.fq OPF1_r2_l2_val_2.fq > OPF1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OPF1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OPF1_r1_l3_val_1.fq OPF1_r2_l3_val_2.fq > OPF1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OPF1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OPF1_r1_l4_val_1.fq OPF1_r2_l4_val_2.fq > OPF1_l4.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OPM1_l1\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OPM1_r1_l1_val_1.fq OPM1_r2_l1_val_2.fq > OPM1_l1.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OPM1_l2\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OPM1_r1_l2_val_1.fq OPM1_r2_l2_val_2.fq > OPM1_l2.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OPM1_l3\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OPM1_r1_l3_val_1.fq OPM1_r2_l3_val_2.fq > OPM1_l3.sam'
bsub -n 8 -R "span[hosts=1]" -M 50 -q whole_node 'bwa mem -aM -t 8 -R "@RG\tID:group1\tSM:OPM1_l4\tPL:illumina\tLB:lib1" /proj/cmarlab/users/joe/Cyprinodon/Cyprinodon_NW_noheader.fasta OPM1_r1_l4_val_1.fq OPM1_r2_l4_val_2.fq > OPM1_l4.sam'

bsub -q week "samtools view -Shu CAF1_l1.sam > CAF1_l1.bam"
bsub -q week "samtools view -Shu CAF1_l2.sam > CAF1_l2.bam"
bsub -q week "samtools view -Shu CAF1_l3.sam > CAF1_l3.bam"
bsub -q week "samtools view -Shu CAF1_l4.sam > CAF1_l4.bam"
bsub -q week "samtools view -Shu CAM1_l1.sam > CAM1_l1.bam"
bsub -q week "samtools view -Shu CAM1_l2.sam > CAM1_l2.bam"
bsub -q week "samtools view -Shu CAM1_l3.sam > CAM1_l3.bam"
bsub -q week "samtools view -Shu CAM1_l4.sam > CAM1_l4.bam"
bsub -q week "samtools view -Shu CAM2_l1.sam > CAM2_l1.bam"
bsub -q week "samtools view -Shu CAM2_l2.sam > CAM2_l2.bam"
bsub -q week "samtools view -Shu CAM2_l3.sam > CAM2_l3.bam"
bsub -q week "samtools view -Shu CAM2_l4.sam > CAM2_l4.bam"
bsub -q week "samtools view -Shu CMF1_l1.sam > CMF1_l1.bam"
bsub -q week "samtools view -Shu CMF1_l2.sam > CMF1_l2.bam"
bsub -q week "samtools view -Shu CMF1_l3.sam > CMF1_l3.bam"
bsub -q week "samtools view -Shu CMF1_l4.sam > CMF1_l4.bam"
bsub -q week "samtools view -Shu CMM1_l1.sam > CMM1_l1.bam"
bsub -q week "samtools view -Shu CMM1_l2.sam > CMM1_l2.bam"
bsub -q week "samtools view -Shu CMM1_l3.sam > CMM1_l3.bam"
bsub -q week "samtools view -Shu CMM1_l4.sam > CMM1_l4.bam"
bsub -q week "samtools view -Shu CPF1_l1.sam > CPF1_l1.bam"
bsub -q week "samtools view -Shu CPF1_l2.sam > CPF1_l2.bam"
bsub -q week "samtools view -Shu CPF1_l3.sam > CPF1_l3.bam"
bsub -q week "samtools view -Shu CPF1_l4.sam > CPF1_l4.bam"
bsub -q week "samtools view -Shu CPM1_l1.sam > CPM1_l1.bam"
bsub -q week "samtools view -Shu CPM1_l2.sam > CPM1_l2.bam"
bsub -q week "samtools view -Shu CPM1_l3.sam > CPM1_l3.bam"
bsub -q week "samtools view -Shu CPM1_l4.sam > CPM1_l4.bam"
bsub -q week "samtools view -Shu CUNP_l1.sam > CUNP_l1.bam"
bsub -q week "samtools view -Shu CUNP_l2.sam > CUNP_l2.bam"
bsub -q week "samtools view -Shu CUNP_l3.sam > CUNP_l3.bam"
bsub -q week "samtools view -Shu CUNP_l4.sam > CUNP_l4.bam"
bsub -q week "samtools view -Shu NAF1_l1.sam > NAF1_l1.bam"
bsub -q week "samtools view -Shu NAF1_l2.sam > NAF1_l2.bam"
bsub -q week "samtools view -Shu NAF1_l3.sam > NAF1_l3.bam"
bsub -q week "samtools view -Shu NAF1_l4.sam > NAF1_l4.bam"
bsub -q week "samtools view -Shu OAF1_l1.sam > OAF1_l1.bam"
bsub -q week "samtools view -Shu OAF1_l2.sam > OAF1_l2.bam"
bsub -q week "samtools view -Shu OAF1_l3.sam > OAF1_l3.bam"
bsub -q week "samtools view -Shu OAF1_l4.sam > OAF1_l4.bam"
bsub -q week "samtools view -Shu OAM1_l1.sam > OAM1_l1.bam"
bsub -q week "samtools view -Shu OAM1_l2.sam > OAM1_l2.bam"
bsub -q week "samtools view -Shu OAM1_l3.sam > OAM1_l3.bam"
bsub -q week "samtools view -Shu OAM1_l4.sam > OAM1_l4.bam"
bsub -q week "samtools view -Shu OMF1_l1.sam > OMF1_l1.bam"
bsub -q week "samtools view -Shu OMF1_l2.sam > OMF1_l2.bam"
bsub -q week "samtools view -Shu OMF1_l3.sam > OMF1_l3.bam"
bsub -q week "samtools view -Shu OMF1_l4.sam > OMF1_l4.bam"
bsub -q week "samtools view -Shu OMM1_l1.sam > OMM1_l1.bam"
bsub -q week "samtools view -Shu OMM1_l2.sam > OMM1_l2.bam"
bsub -q week "samtools view -Shu OMM1_l3.sam > OMM1_l3.bam"
bsub -q week "samtools view -Shu OMM1_l4.sam > OMM1_l4.bam"
bsub -q week "samtools view -Shu OPF1_l1.sam > OPF1_l1.bam"
bsub -q week "samtools view -Shu OPF1_l2.sam > OPF1_l2.bam"
bsub -q week "samtools view -Shu OPF1_l3.sam > OPF1_l3.bam"
bsub -q week "samtools view -Shu OPF1_l4.sam > OPF1_l4.bam"
bsub -q week "samtools view -Shu OPM1_l1.sam > OPM1_l1.bam"
bsub -q week "samtools view -Shu OPM1_l2.sam > OPM1_l2.bam"
bsub -q week "samtools view -Shu OPM1_l3.sam > OPM1_l3.bam"
bsub -q week "samtools view -Shu OPM1_l4.sam > OPM1_l4.bam"

bsub -q week "samtools merge CAF1.bam CAF1_l1.bam CAF1_l2.bam CAF1_l3.bam CAF1_l4.bam"
bsub -q week "samtools merge CAM1.bam CAM1_l1.bam CAM1_l2.bam CAM1_l3.bam CAM1_l4.bam"
bsub -q week "samtools merge CAM2.bam CAM2_l1.bam CAM2_l2.bam CAM2_l3.bam CAM2_l4.bam"
bsub -q week "samtools merge CMF1.bam CMF1_l1.bam CMF1_l2.bam CMF1_l3.bam CMF1_l4.bam"
bsub -q week "samtools merge CMM1.bam CMM1_l1.bam CMM1_l2.bam CMM1_l3.bam CMM1_l4.bam"
bsub -q week "samtools merge CPF1.bam CPF1_l1.bam CPF1_l2.bam CPF1_l3.bam CPF1_l4.bam"
bsub -q week "samtools merge CPM1.bam CPM1_l1.bam CPM1_l2.bam CPM1_l3.bam CPM1_l4.bam"
bsub -q week "samtools merge CUNP.bam CUNP_l1.bam CUNP_l2.bam CUNP_l3.bam CUNP_l4.bam"
bsub -q week "samtools merge NAF1.bam NAF1_l1.bam NAF1_l2.bam NAF1_l3.bam NAF1_l4.bam"
bsub -q week "samtools merge OAF1.bam OAF1_l1.bam OAF1_l2.bam OAF1_l3.bam OAF1_l4.bam"
bsub -q week "samtools merge OAM1.bam OAM1_l1.bam OAM1_l2.bam OAM1_l3.bam OAM1_l4.bam"
bsub -q week "samtools merge OMF1.bam OMF1_l1.bam OMF1_l2.bam OMF1_l3.bam OMF1_l4.bam"
bsub -q week "samtools merge OMM1.bam OMM1_l1.bam OMM1_l2.bam OMM1_l3.bam OMM1_l4.bam"
bsub -q week "samtools merge OPF1.bam OPF1_l1.bam OPF1_l2.bam OPF1_l3.bam OPF1_l4.bam"
bsub -q week "samtools merge OPM1.bam OPM1_l1.bam OPM1_l2.bam OPM1_l3.bam OPM1_l4.bam"




module load r/3.4.1 
install.packages(c('getopt', 'binom', 'VGAM'))
66
/pine/scr/j/m/jmcgirr/geneiase/geneiase-1.0.1/bin/geneiase -t static -i CAE1_test.txt -b 100

# bedops and bedtools
bedtools intersect -a Cyprinodon_NW_noheader_20kb_winds.bed -b /proj/cmarlab/users/joe/gemma/scripts/run_gemma/output/mean_params_low_jaw.bed > tester.txt

sed "s/\W\W/\t/g" /proj/cmarlab/users/joe/gemma/scripts/run_gemma/output/mean_params_low_jaw.bed > bed2.bed
sed "s/\W\W/\t/g" Cyprinodon_NW_noheader_20kb_winds.bed > bed1.bed

bedtools intersect -a bed1.bed -b bed2.bed > tester.txt
sort-bed --max-mem 2G tester.txt > tester.sort.txt
sort-bed /proj/cmarlab/users/joe/gemma/scripts/run_gemma/output/mean_params_low_jaw.bed_gammas.txt > gammas.sort.bed 

bedmap --skip-unmapped --echo --echo-map /proj/cmarlab/users/joe/gemma/scripts/run_gemma/output/mean_params_low_jaw.bed.txt Cyprinodon_NW_noheader_20kb_winds.bed > tester.txt
bedmap --skip-unmapped --echo --sum Cyprinodon_NW_noheader_20kb_winds.bed /proj/cmarlab/users/joe/gemma/scripts/run_gemma/output/mean_params_low_jaw.bed.txt > answer.bed


bedops --chop 20000 Cyprinodon_brontotheroides_chromSizes.txt > Cyprinodon_brontotheroides_20kb_winds.bed
bedtools sort -i /proj/cmarlab/users/joe/gemma/scripts/run_gemma/output/mean_params_low_jaw.bed_gammas.txt > gammas.sort.bed
bedmap --skip-unmapped --echo --sum chopped_20kb.bed /proj/cmarlab/users/joe/gemma/scripts/run_gemma/output/mean_params_low_jaw.bed_gammas.txt > answer.bed
bedmap --skip-unmapped --echo --sum chopped_20kb.bed gammas.sort.bed > answer.bed

sort-bed MP_95th_P_sweep_20k_window_dxy_fst_snps.bed  > MP_95th_P_sweep_20k_window_dxy_fst_snps.sort.bed
sort-bed MP_fixed_M_sweep_20k_window_dxy_fst_snps.bed > MP_fixed_M_sweep_20k_window_dxy_fst_snps.sort.bed

bedmap --skip-unmapped --echo candidates_low_jaw_95percentile.sort.bed  MP_95th_P_sweep_20k_window_dxy_fst_snps.sort.bed > MP_95th_P_sweep_20k_window_dxy_fst_low_jaw_candidate_regions_containing_snps.txt
bedmap --skip-unmapped --echo --echo-map MP_95th_P_sweep_20k_window_dxy_fst_snps.sort.bed candidates_low_jaw_95percentile.sort.bed > MP_95th_P_sweep_20k_window_dxy_fst_snps_in_low_jaw_candidate_regions.txt


sort-bed Cyprinodon_NW_noheader_mrna.bed     > Cyprinodon_NW_noheader_mrna.sort.bed    
sort-bed candidates_low_jaw_95percentile.bed > candidates_low_jaw_95percentile.sort.bed
sort-bed candidates_up_jaw_95percentile.bed  > candidates_up_jaw_95percentile.sort.bed 

bedmap --skip-unmapped --echo Cyprinodon_NW_noheader_mrna.sort.bed  candidates_low_jaw_95percentile.sort.bed > candidates_low_jaw_95percentile.genes.txt
bedmap --skip-unmapped --echo Cyprinodon_NW_noheader_mrna.sort.bed  candidates_up_jaw_95percentile.sort.bed > candidates_up_jaw_95percentile.genes.txt

sort-bed candidates_31_mbe.bed > candidates_31_mbe.sort.bed
bedmap --skip-unmapped --echo candidates_up_jaw_95percentile.sort.bed  candidates_31_mbe.sort.bed > answer.txt

bedtools intersect -a candidates_low_jaw_99percentile.sort.bed  -b Cyprinodon_NW_noheader_mrna.sort.bed -loj > candidates_low_jaw_99percentile.genes.txt
bedtools intersect -a candidates_up_jaw_99percentile.sort.bed  -b Cyprinodon_NW_noheader_mrna.sort.bed -loj > candidates_up_jaw_99percentile.genes.txt

awk '{$3=$2+19999}1' a_taj_d_20kb.txt.Tajima.D | tail -n +2 > a_taj_d_20kb.txt.Tajima.D.bed
sort-bed a_taj_d_20kb.txt.Tajima.D.bed > a_taj_d.txt.Tajima.D.sort.bed

bedmap --skip-unmapped --echo --echo-map /proj/cmarlab/users/joe/gemma/candidates/candidates_up_jaw_95percentile.genes.sort.txt a_taj_d.txt.Tajima.D.sort.bed  > answer.txt
bedtools intersect -a /proj/cmarlab/users/joe/gemma/candidates/candidates_up_jaw_95percentile.genes.sort.txt -b a_taj_d.txt.Tajima.D.sort.bed -wa -wb > answer.txt
dos2unix answer.txt | head