scp -r cornell_rna martin-lab@bio-martin-syn.bio.unc.edu:/volume1/MartinLab/Joe/RNA_seq/Lencer_RNA
scp -r axm_rna martin-lab@bio-martin-syn.bio.unc.edu:/volume1/MartinLab/Joe/killdevil_backup_1_12_2018/joe
\\martinbackup\MartinLab\Joe\RNA_seq\F0\stringtie_bams
password: There!sN0Spoon

#QC REPORT WITH MULTIQC (run in directory with files to analyze, will recognize .log files)
bsub -q week "multiqc ."

#TRIM GALORE (PHRED SCORE 20)
bsub -q week "trim_galore -q 20 --paired --illumina CPAE1-2nd_Prep_CGCTCATT-GTACTGAC_S217_L005_R1_001.fastq CPAE1-2nd_Prep_CGCTCATT-GTACTGAC_S217_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLAJ2-2nd_Prep_ATTACTCG-ATAGAGGC_S226_L005_R1_001.fastq LLAJ2-2nd_Prep_ATTACTCG-ATAGAGGC_S226_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPAJ1-2nd_Prep_CGCTCATT-ATAGAGGC_S244_L005_R1_001.fastq CPAJ1-2nd_Prep_CGCTCATT-ATAGAGGC_S244_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPAJ3-2nd_Prep_CGCTCATT-GGCTCTGA_S242_L005_R1_001.fastq CPAJ3-2nd_Prep_CGCTCATT-GGCTCTGA_S242_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPMJ1-2nd_Prep_CGCTCATT-AGGCGAAG_S238_L005_R1_001.fastq CPMJ1-2nd_Prep_CGCTCATT-AGGCGAAG_S238_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPAE2-_GAGATTCC-TATAGCCT_S218_L005_R1_001.fastq CPAE2-_GAGATTCC-TATAGCCT_S218_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPAE3-_GAGATTCC-ATAGAGGC_S245_L005_R1_001.fastq CPAE3-_GAGATTCC-ATAGAGGC_S245_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPAJ2-_CGCTCATT-CCTATCCT_S243_L005_R1_001.fastq CPAJ2-_CGCTCATT-CCTATCCT_S243_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPME1-_GAGATTCC-CCTATCCT_S241_L005_R1_001.fastq CPME1-_GAGATTCC-CCTATCCT_S241_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPME2-_GAGATTCC-GGCTCTGA_S240_L005_R1_001.fastq CPME2-_GAGATTCC-GGCTCTGA_S240_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPME3-_GAGATTCC-AGGCGAAG_S239_L005_R1_001.fastq CPME3-_GAGATTCC-AGGCGAAG_S239_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPMJ2-_CGCTCATT-TAATCTTA_S237_L005_R1_001.fastq CPMJ2-_CGCTCATT-TAATCTTA_S237_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPMJ3-_CGCTCATT-CAGGACGT_S236_L005_R1_001.fastq CPMJ3-_CGCTCATT-CAGGACGT_S236_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPPE1-_TCCGGAGA-CAGGACGT_S235_L005_R1_001.fastq CPPE1-_TCCGGAGA-CAGGACGT_S235_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPPE2-_TCCGGAGA-GTACTGAC_S234_L005_R1_001.fastq CPPE2-_TCCGGAGA-GTACTGAC_S234_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPPE3-_CGCTCATT-TATAGCCT_S233_L005_R1_001.fastq CPPE3-_CGCTCATT-TATAGCCT_S233_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPPJ1-_TCCGGAGA-AGGCGAAG_S232_L005_R1_001.fastq CPPJ1-_TCCGGAGA-AGGCGAAG_S232_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina CPPJ2-_TCCGGAGA-TAATCTTA_S231_L005_R1_001.fastq CPPJ2-_TCCGGAGA-TAATCTTA_S231_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLAE1-_ATTACTCG-CAGGACGT_S230_L005_R1_001.fastq LLAE1-_ATTACTCG-CAGGACGT_S230_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLAE2-_ATTACTCG-GTACTGAC_S229_L005_R1_001.fastq LLAE2-_ATTACTCG-GTACTGAC_S229_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLAE3-_TCCGGAGA-TATAGCCT_S228_L005_R1_001.fastq LLAE3-_TCCGGAGA-TATAGCCT_S228_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLAJ1-_ATTACTCG-TATAGCCT_S227_L005_R1_001.fastq LLAJ1-_ATTACTCG-TATAGCCT_S227_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLAJ3-_ATTACTCG-CCTATCCT_S225_L005_R1_001.fastq LLAJ3-_ATTACTCG-CCTATCCT_S225_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLME1-_TCCGGAGA-ATAGAGGC_S224_L005_R1_001.fastq LLME1-_TCCGGAGA-ATAGAGGC_S224_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLME2-_TCCGGAGA-CCTATCCT_S223_L005_R1_001.fastq LLME2-_TCCGGAGA-CCTATCCT_S223_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLME3-_TCCGGAGA-GGCTCTGA_S222_L005_R1_001.fastq LLME3-_TCCGGAGA-GGCTCTGA_S222_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLMJ1-_ATTACTCG-GGCTCTGA_S221_L005_R1_001.fastq LLMJ1-_ATTACTCG-GGCTCTGA_S221_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLMJ2-_ATTACTCG-AGGCGAAG_S220_L005_R1_001.fastq LLMJ2-_ATTACTCG-AGGCGAAG_S220_L005_R2_001.fastq"
bsub -q week "trim_galore -q 20 --paired --illumina LLMJ3-_ATTACTCG-TAATCTTA_S219_L005_R1_001.fastq LLMJ3-_ATTACTCG-TAATCTTA_S219_L005_R2_001.fastq"

#dedup
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=axmE1.sort.bam      OUTPUT=axmE1.sort.dedup.bam METRICS_FILE=axmE1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=axmE2.sort.bam      OUTPUT=axmE2.sort.dedup.bam METRICS_FILE=axmE2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=axmJ1.sort.bam      OUTPUT=axmJ1.sort.dedup.bam METRICS_FILE=axmJ1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=axmJ4.sort.bam      OUTPUT=axmJ4.sort.dedup.bam METRICS_FILE=axmJ4.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=axmJ5.sort.bam      OUTPUT=axmJ5.sort.dedup.bam METRICS_FILE=axmJ5.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=axmJ6.sort.bam      OUTPUT=axmJ6.sort.dedup.bam METRICS_FILE=axmJ6.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPAE1.rna.sort.bam  OUTPUT=CPAE1.sort.dedup.bam METRICS_FILE=CPAE1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPAE2.rna.sort.bam  OUTPUT=CPAE2.sort.dedup.bam METRICS_FILE=CPAE2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPAE3.rna.sort.bam  OUTPUT=CPAE3.sort.dedup.bam METRICS_FILE=CPAE3.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPAJ1.rna.sort.bam  OUTPUT=CPAJ1.sort.dedup.bam METRICS_FILE=CPAJ1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPAJ2.rna.sort.bam  OUTPUT=CPAJ2.sort.dedup.bam METRICS_FILE=CPAJ2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPAJ3.rna.sort.bam  OUTPUT=CPAJ3.sort.dedup.bam METRICS_FILE=CPAJ3.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPME1.rna.sort.bam  OUTPUT=CPME1.sort.dedup.bam METRICS_FILE=CPME1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPME2.rna.sort.bam  OUTPUT=CPME2.sort.dedup.bam METRICS_FILE=CPME2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPME3.rna.sort.bam  OUTPUT=CPME3.sort.dedup.bam METRICS_FILE=CPME3.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPMJ1.rna.sort.bam  OUTPUT=CPMJ1.sort.dedup.bam METRICS_FILE=CPMJ1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPMJ2.rna.sort.bam  OUTPUT=CPMJ2.sort.dedup.bam METRICS_FILE=CPMJ2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPMJ3.rna.sort.bam  OUTPUT=CPMJ3.sort.dedup.bam METRICS_FILE=CPMJ3.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPPE1.rna.sort.bam  OUTPUT=CPPE1.sort.dedup.bam METRICS_FILE=CPPE1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPPE2.rna.sort.bam  OUTPUT=CPPE2.sort.dedup.bam METRICS_FILE=CPPE2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPPE3.rna.sort.bam  OUTPUT=CPPE3.sort.dedup.bam METRICS_FILE=CPPE3.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPPJ1.rna.sort.bam  OUTPUT=CPPJ1.sort.dedup.bam METRICS_FILE=CPPJ1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=CPPJ2.rna.sort.bam  OUTPUT=CPPJ2.sort.dedup.bam METRICS_FILE=CPPJ2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLAE1.rna.sort.bam  OUTPUT=LLAE1.sort.dedup.bam METRICS_FILE=LLAE1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLAE2.rna.sort.bam  OUTPUT=LLAE2.sort.dedup.bam METRICS_FILE=LLAE2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLAE3.rna.sort.bam  OUTPUT=LLAE3.sort.dedup.bam METRICS_FILE=LLAE3.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLAJ1.rna.sort.bam  OUTPUT=LLAJ1.sort.dedup.bam METRICS_FILE=LLAJ1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLAJ2.rna.sort.bam  OUTPUT=LLAJ2.sort.dedup.bam METRICS_FILE=LLAJ2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLAJ3.rna.sort.bam  OUTPUT=LLAJ3.sort.dedup.bam METRICS_FILE=LLAJ3.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLME1.rna.sort.bam  OUTPUT=LLME1.sort.dedup.bam METRICS_FILE=LLME1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLME2.rna.sort.bam  OUTPUT=LLME2.sort.dedup.bam METRICS_FILE=LLME2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLME3.rna.sort.bam  OUTPUT=LLME3.sort.dedup.bam METRICS_FILE=LLME3.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLMJ1.rna.sort.bam  OUTPUT=LLMJ1.sort.dedup.bam METRICS_FILE=LLMJ1.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLMJ2.rna.sort.bam  OUTPUT=LLMJ2.sort.dedup.bam METRICS_FILE=LLMJ2.metrics.txt MAX_FILE_HANDLES=1000"
bsub -M 50 -q week "java -jar picard.jar MarkDuplicates INPUT=LLMJ3.rna.sort.bam  OUTPUT=LLMJ3.sort.dedup.bam METRICS_FILE=LLMJ3.metrics.txt MAX_FILE_HANDLES=1000"


#CREATE GTF FILE FROM GFF3
bsub -q week "gffread ref_C_variegatus-1.0_scaffolds.gff3 -T -o my.gtf"

#### STAR (mapping reads) ####

module load star
module load subread 

#CREATE GENOME INDEXES
bsub -n 4 -R "span[hosts=1]" -q whole_node -M 100 "star --runThreadN 4 \
--runMode genomeGenerate \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--genomeFastaFiles /proj/cmarlab/users/joe/outgroups/rna/Cyprinodon_NW.fasta \
--sjdbGTFfile ref_C_variegatus-1.0_scaffolds.gff3 \
--sjdbGTFtagExonParentTranscript Parent \
--sjdbOverhang 149"




#MAP READS
bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn LLAJ2-2nd_Prep_ATTACTCG-ATAGAGGC_S226_L005_R1_001_val_1.fq LLAJ2-2nd_Prep_ATTACTCG-ATAGAGGC_S226_L005_R2_001_val_2.fq \
--outFileNamePrefix LLAJ2"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPMJ1-2nd_Prep_CGCTCATT-AGGCGAAG_S238_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPMJ1-2nd_Prep_CGCTCATT-AGGCGAAG_S238_L005_R2_001_val_2.fq \
--outFileNamePrefix CPMJ1"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAJ3-2nd_Prep_CGCTCATT-GGCTCTGA_S242_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAJ3-2nd_Prep_CGCTCATT-GGCTCTGA_S242_L005_R2_001_val_2.fq \
--outFileNamePrefix CPAJ3"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAJ1-2nd_Prep_CGCTCATT-ATAGAGGC_S244_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAJ1-2nd_Prep_CGCTCATT-ATAGAGGC_S244_L005_R2_001_val_2.fq \
--outFileNamePrefix CPAJ1"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAE1-2nd_Prep_CGCTCATT-GTACTGAC_S217_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAE1-2nd_Prep_CGCTCATT-GTACTGAC_S217_L005_R2_001_val_2.fq \
--outFileNamePrefix CPAE1"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAE2-_GAGATTCC-TATAGCCT_S218_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAE2-_GAGATTCC-TATAGCCT_S218_L005_R2_001_val_2.fq \
--outFileNamePrefix CPAE2"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAE3-_GAGATTCC-ATAGAGGC_S245_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAE3-_GAGATTCC-ATAGAGGC_S245_L005_R2_001_val_2.fq \
--outFileNamePrefix CPAE3"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAJ2-_CGCTCATT-CCTATCCT_S243_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPAJ2-_CGCTCATT-CCTATCCT_S243_L005_R2_001_val_2.fq \
--outFileNamePrefix CPAJ2"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPME1-_GAGATTCC-CCTATCCT_S241_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPME1-_GAGATTCC-CCTATCCT_S241_L005_R2_001_val_2.fq \
--outFileNamePrefix CPME1"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPME2-_GAGATTCC-GGCTCTGA_S240_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPME2-_GAGATTCC-GGCTCTGA_S240_L005_R2_001_val_2.fq \
--outFileNamePrefix CPME2"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPME3-_GAGATTCC-AGGCGAAG_S239_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPME3-_GAGATTCC-AGGCGAAG_S239_L005_R2_001_val_2.fq \
--outFileNamePrefix CPME3"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPMJ2-_CGCTCATT-TAATCTTA_S237_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPMJ2-_CGCTCATT-TAATCTTA_S237_L005_R2_001_val_2.fq \
--outFileNamePrefix CPMJ2"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPMJ3-_CGCTCATT-CAGGACGT_S236_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPMJ3-_CGCTCATT-CAGGACGT_S236_L005_R2_001_val_2.fq \
--outFileNamePrefix CPMJ3"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPPE1-_TCCGGAGA-CAGGACGT_S235_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPPE1-_TCCGGAGA-CAGGACGT_S235_L005_R2_001_val_2.fq \
--outFileNamePrefix CPPE1"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPPE2-_TCCGGAGA-GTACTGAC_S234_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPPE2-_TCCGGAGA-GTACTGAC_S234_L005_R2_001_val_2.fq \
--outFileNamePrefix CPPE2"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPPE3-_CGCTCATT-TATAGCCT_S233_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPPE3-_CGCTCATT-TATAGCCT_S233_L005_R2_001_val_2.fq \
--outFileNamePrefix CPPE3"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPPJ1-_TCCGGAGA-AGGCGAAG_S232_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPPJ1-_TCCGGAGA-AGGCGAAG_S232_L005_R2_001_val_2.fq \
--outFileNamePrefix CPPJ1"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPPJ2-_TCCGGAGA-TAATCTTA_S231_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/CPPJ2-_TCCGGAGA-TAATCTTA_S231_L005_R2_001_val_2.fq \
--outFileNamePrefix CPPJ2"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLAE1-_ATTACTCG-CAGGACGT_S230_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLAE1-_ATTACTCG-CAGGACGT_S230_L005_R2_001_val_2.fq \
--outFileNamePrefix LLAE1"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLAE2-_ATTACTCG-GTACTGAC_S229_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLAE2-_ATTACTCG-GTACTGAC_S229_L005_R2_001_val_2.fq \
--outFileNamePrefix LLAE2"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLAE3-_TCCGGAGA-TATAGCCT_S228_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLAE3-_TCCGGAGA-TATAGCCT_S228_L005_R2_001_val_2.fq \
--outFileNamePrefix LLAE3"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLAJ1-_ATTACTCG-TATAGCCT_S227_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLAJ1-_ATTACTCG-TATAGCCT_S227_L005_R2_001_val_2.fq \
--outFileNamePrefix LLAJ1"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLAJ3-_ATTACTCG-CCTATCCT_S225_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLAJ3-_ATTACTCG-CCTATCCT_S225_L005_R2_001_val_2.fq \
--outFileNamePrefix LLAJ3"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLME1-_TCCGGAGA-ATAGAGGC_S224_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLME1-_TCCGGAGA-ATAGAGGC_S224_L005_R2_001_val_2.fq \
--outFileNamePrefix LLME1"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLME2-_TCCGGAGA-CCTATCCT_S223_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLME2-_TCCGGAGA-CCTATCCT_S223_L005_R2_001_val_2.fq \
--outFileNamePrefix LLME2"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLME3-_TCCGGAGA-GGCTCTGA_S222_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLME3-_TCCGGAGA-GGCTCTGA_S222_L005_R2_001_val_2.fq \
--outFileNamePrefix LLME3"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLMJ1-_ATTACTCG-GGCTCTGA_S221_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLMJ1-_ATTACTCG-GGCTCTGA_S221_L005_R2_001_val_2.fq \
--outFileNamePrefix LLMJ1"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLMJ2-_ATTACTCG-AGGCGAAG_S220_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLMJ2-_ATTACTCG-AGGCGAAG_S220_L005_R2_001_val_2.fq \
--outFileNamePrefix LLMJ2"

bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "star --runThreadN 4 \
--genomeDir /proj/cmarlab/users/joe/outgroups/rna/genome_dir \
--readFilesIn /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLMJ3-_ATTACTCG-TAATCTTA_S219_L005_R1_001_val_1.fq \
/proj/cmarlab/users/joe/outgroups/rna/fastq_reads/LLMJ3-_ATTACTCG-TAATCTTA_S219_L005_R2_001_val_2.fq \
--outFileNamePrefix LLMJ3"




#COUNT READS 
bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "featureCounts -p -a my.gtf.geneid -B -C -G Cyprinodon_NW.fasta -s 2 -T 4 -o counts_geneid CPAE1.rna.bam CPAE2.rna.bam CPAE3.rna.bam CPAJ1.rna.bam CPAJ2.rna.bam CPAJ3.rna.bam CPME1.rna.bam CPME2.rna.bam CPME3.rna.bam CPMJ1.rna.bam CPMJ2.rna.bam CPMJ3.rna.bam CPPE1.rna.bam CPPE2.rna.bam CPPE3.rna.bam CPPJ1.rna.bam CPPJ2.rna.bam LLAE1.rna.bam LLAE2.rna.bam LLAE3.rna.bam LLAJ1.rna.bam LLAJ2.rna.bam LLAJ3.rna.bam LLME1.rna.bam LLME2.rna.bam LLME3.rna.bam LLMJ1.rna.bam LLMJ2.rna.bam LLMJ3.rna.bam"
bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "featureCounts -p -a /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/tophat_out_threaded/cufflinks_out_gtf/transcripts.gtf -B -C -G Cyprinodon_NW.fa -s 2 -T 4 -o counts_cufflinks_transcripts CPAE1.rna.bam CPAE2.rna.bam CPAE3.rna.bam CPAJ1.rna.bam CPAJ2.rna.bam CPAJ3.rna.bam CPME1.rna.bam CPME2.rna.bam CPME3.rna.bam CPMJ1.rna.bam CPMJ2.rna.bam CPMJ3.rna.bam CPPE1.rna.bam CPPE2.rna.bam CPPE3.rna.bam CPPJ1.rna.bam CPPJ2.rna.bam LLAE1.rna.bam LLAE2.rna.bam LLAE3.rna.bam LLAJ1.rna.bam LLAJ2.rna.bam LLAJ3.rna.bam LLME1.rna.bam LLME2.rna.bam LLME3.rna.bam LLMJ1.rna.bam LLMJ2.rna.bam LLMJ3.rna.bam"
bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "featureCounts -p -a /proj/cmarlab/users/joe/Cyprinodon/ref_C_variegatus-1.0_scaffolds.gff3 -B -C -G Cyprinodon_NW.fasta -s 2 -T 4 -o counts_amp CPAE1.sort.dedup.bam CPAE2.sort.dedup.bam CPAE3.sort.dedup.bam CPAJ1.sort.dedup.bam CPAJ2.sort.dedup.bam CPAJ3.sort.dedup.bam CPME1.sort.dedup.bam CPME2.sort.dedup.bam CPME3.sort.dedup.bam CPMJ1.sort.dedup.bam CPMJ2.sort.dedup.bam CPMJ3.sort.dedup.bam CPPE1.sort.dedup.bam CPPE2.sort.dedup.bam CPPE3.sort.dedup.bam CPPJ1.sort.dedup.bam CPPJ2.sort.dedup.bam LLAE1.sort.dedup.bam LLAE2.sort.dedup.bam LLAE3.sort.dedup.bam LLAJ1.sort.dedup.bam LLAJ2.sort.dedup.bam LLAJ3.sort.dedup.bam LLME1.sort.dedup.bam LLME2.sort.dedup.bam LLME3.sort.dedup.bam LLMJ1.sort.dedup.bam LLMJ2.sort.dedup.bam LLMJ3.sort.dedup.bam"
bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "featureCounts -p -a /proj/cmarlab/users/joe/Cyprinodon/my.gtf.geneid -B -C -G Cyprinodon_NW.fasta -s 2 -T 4 -o counts_amp_geneid CPAE1.sort.dedup.bam CPAE2.sort.dedup.bam CPAE3.sort.dedup.bam CPAJ1.sort.dedup.bam CPAJ2.sort.dedup.bam CPAJ3.sort.dedup.bam CPME1.sort.dedup.bam CPME2.sort.dedup.bam CPME3.sort.dedup.bam CPMJ1.sort.dedup.bam CPMJ2.sort.dedup.bam CPMJ3.sort.dedup.bam CPPE1.sort.dedup.bam CPPE2.sort.dedup.bam CPPE3.sort.dedup.bam CPPJ1.sort.dedup.bam CPPJ2.sort.dedup.bam LLAE1.sort.dedup.bam LLAE2.sort.dedup.bam LLAE3.sort.dedup.bam LLAJ1.sort.dedup.bam LLAJ2.sort.dedup.bam LLAJ3.sort.dedup.bam LLME1.sort.dedup.bam LLME2.sort.dedup.bam LLME3.sort.dedup.bam LLMJ1.sort.dedup.bam LLMJ2.sort.dedup.bam LLMJ3.sort.dedup.bam"


bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "featureCounts -p -a my.gtf.geneid -B -C -G Cyprinodon_NW.fasta -s 2 -T 4 -o counts_geneid CPAE2Aligned.out.sam CPAE3Aligned.out.sam CPAJ2Aligned.out.sam CPME1Aligned.out.sam CPME2Aligned.out.sam CPME3Aligned.out.sam CPMJ2Aligned.out.sam CPMJ3Aligned.out.sam CPPE1Aligned.out.sam CPPE2Aligned.out.sam CPPE3Aligned.out.sam CPPJ1Aligned.out.sam CPPJ2Aligned.out.sam LLAE1Aligned.out.sam LLAE2Aligned.out.sam LLAE3Aligned.out.sam LLAJ1Aligned.out.sam LLAJ3Aligned.out.sam LLME1Aligned.out.sam LLME2Aligned.out.sam LLME3Aligned.out.sam LLMJ1Aligned.out.sam LLMJ2Aligned.out.sam LLMJ3Aligned.out.sam CPAE1Aligned.out.sam LLAJ2Aligned.out.sam CPMJ1Aligned.out.sam CPAJ3Aligned.out.sam CPAJ1Aligned.out.sam"
tail -25050 counts_cufflinks_transcripts | sed "s/.rna.bam//g" > tester
sed -i '3765d' counts_my_gtf_post_trim_multi_map


#STRINGTIE
bsub -n 4 -R "span[hosts=1]" -q whole_node -M 50 "stringtie CPAE1.rna.sort.bam CPAE2.rna.sort.bam CPAE3.rna.sort.bam CPAJ1.rna.sort.bam CPAJ2.rna.sort.bam CPAJ3.rna.sort.bam CPME1.rna.sort.bam CPME2.rna.sort.bam CPME3.rna.sort.bam CPMJ1.rna.sort.bam CPMJ2.rna.sort.bam CPMJ3.rna.sort.bam CPPE1.rna.sort.bam CPPE2.rna.sort.bam CPPE3.rna.sort.bam CPPJ1.rna.sort.bam CPPJ2.rna.sort.bam LLAE1.rna.sort.bam LLAE2.rna.sort.bam LLAE3.rna.sort.bam LLAJ1.rna.sort.bam LLAJ2.rna.sort.bam LLAJ3.rna.sort.bam LLME1.rna.sort.bam LLME2.rna.sort.bam LLME3.rna.sort.bam LLMJ1.rna.sort.bam LLMJ2.rna.sort.bam LLMJ3.rna.sort.bam -A --rf -p 4 -o stringtie.gtf" 

#TOPHAT
bsub -n 8 -R "span[hosts=1]" -q whole_node -M 50 "tophat -p 8 -o ./tophat_out_threaded --library-type fr-firststrand Cyprinodon_NW LLAJ2-2nd_Prep_ATTACTCG-ATAGAGGC_S226_L005_R1_001_val_1.fq,CPMJ1-2nd_Prep_CGCTCATT-AGGCGAAG_S238_L005_R1_001_val_1.fq,CPAJ3-2nd_Prep_CGCTCATT-GGCTCTGA_S242_L005_R1_001_val_1.fq,CPAJ1-2nd_Prep_CGCTCATT-ATAGAGGC_S244_L005_R1_001_val_1.fq,CPAE1-2nd_Prep_CGCTCATT-GTACTGAC_S217_L005_R1_001_val_1.fq,CPAE2-_GAGATTCC-TATAGCCT_S218_L005_R1_001_val_1.fq,CPAE3-_GAGATTCC-ATAGAGGC_S245_L005_R1_001_val_1.fq,CPAJ2-_CGCTCATT-CCTATCCT_S243_L005_R1_001_val_1.fq,CPME1-_GAGATTCC-CCTATCCT_S241_L005_R1_001_val_1.fq,CPME2-_GAGATTCC-GGCTCTGA_S240_L005_R1_001_val_1.fq,CPME3-_GAGATTCC-AGGCGAAG_S239_L005_R1_001_val_1.fq,CPMJ2-_CGCTCATT-TAATCTTA_S237_L005_R1_001_val_1.fq,CPMJ3-_CGCTCATT-CAGGACGT_S236_L005_R1_001_val_1.fq,CPPE1-_TCCGGAGA-CAGGACGT_S235_L005_R1_001_val_1.fq,CPPE2-_TCCGGAGA-GTACTGAC_S234_L005_R1_001_val_1.fq,CPPE3-_CGCTCATT-TATAGCCT_S233_L005_R1_001_val_1.fq,CPPJ1-_TCCGGAGA-AGGCGAAG_S232_L005_R1_001_val_1.fq,CPPJ2-_TCCGGAGA-TAATCTTA_S231_L005_R1_001_val_1.fq,LLAE1-_ATTACTCG-CAGGACGT_S230_L005_R1_001_val_1.fq,LLAE2-_ATTACTCG-GTACTGAC_S229_L005_R1_001_val_1.fq,LLAE3-_TCCGGAGA-TATAGCCT_S228_L005_R1_001_val_1.fq,LLAJ1-_ATTACTCG-TATAGCCT_S227_L005_R1_001_val_1.fq,LLAJ3-_ATTACTCG-CCTATCCT_S225_L005_R1_001_val_1.fq,LLME1-_TCCGGAGA-ATAGAGGC_S224_L005_R1_001_val_1.fq,LLME2-_TCCGGAGA-CCTATCCT_S223_L005_R1_001_val_1.fq,LLME3-_TCCGGAGA-GGCTCTGA_S222_L005_R1_001_val_1.fq,LLMJ1-_ATTACTCG-GGCTCTGA_S221_L005_R1_001_val_1.fq,LLMJ2-_ATTACTCG-AGGCGAAG_S220_L005_R1_001_val_1.fq,LLMJ3-_ATTACTCG-TAATCTTA_S219_L005_R1_001_val_1.fq LLAJ2-2nd_Prep_ATTACTCG-ATAGAGGC_S226_L005_R2_001_val_2.fq,CPMJ1-2nd_Prep_CGCTCATT-AGGCGAAG_S238_L005_R2_001_val_2.fq,CPAJ3-2nd_Prep_CGCTCATT-GGCTCTGA_S242_L005_R2_001_val_2.fq,CPAJ1-2nd_Prep_CGCTCATT-ATAGAGGC_S244_L005_R2_001_val_2.fq,CPAE1-2nd_Prep_CGCTCATT-GTACTGAC_S217_L005_R2_001_val_2.fq,CPAE2-_GAGATTCC-TATAGCCT_S218_L005_R2_001_val_2.fq,CPAE3-_GAGATTCC-ATAGAGGC_S245_L005_R2_001_val_2.fq,CPAJ2-_CGCTCATT-CCTATCCT_S243_L005_R2_001_val_2.fq,CPME1-_GAGATTCC-CCTATCCT_S241_L005_R2_001_val_2.fq,CPME2-_GAGATTCC-GGCTCTGA_S240_L005_R2_001_val_2.fq,CPME3-_GAGATTCC-AGGCGAAG_S239_L005_R2_001_val_2.fq,CPMJ2-_CGCTCATT-TAATCTTA_S237_L005_R2_001_val_2.fq,CPMJ3-_CGCTCATT-CAGGACGT_S236_L005_R2_001_val_2.fq,CPPE1-_TCCGGAGA-CAGGACGT_S235_L005_R2_001_val_2.fq,CPPE2-_TCCGGAGA-GTACTGAC_S234_L005_R2_001_val_2.fq,CPPE3-_CGCTCATT-TATAGCCT_S233_L005_R2_001_val_2.fq,CPPJ1-_TCCGGAGA-AGGCGAAG_S232_L005_R2_001_val_2.fq,CPPJ2-_TCCGGAGA-TAATCTTA_S231_L005_R2_001_val_2.fq,LLAE1-_ATTACTCG-CAGGACGT_S230_L005_R2_001_val_2.fq,LLAE2-_ATTACTCG-GTACTGAC_S229_L005_R2_001_val_2.fq,LLAE3-_TCCGGAGA-TATAGCCT_S228_L005_R2_001_val_2.fq,LLAJ1-_ATTACTCG-TATAGCCT_S227_L005_R2_001_val_2.fq,LLAJ3-_ATTACTCG-CCTATCCT_S225_L005_R2_001_val_2.fq,LLME1-_TCCGGAGA-ATAGAGGC_S224_L005_R2_001_val_2.fq,LLME2-_TCCGGAGA-CCTATCCT_S223_L005_R2_001_val_2.fq,LLME3-_TCCGGAGA-GGCTCTGA_S222_L005_R2_001_val_2.fq,LLMJ1-_ATTACTCG-GGCTCTGA_S221_L005_R2_001_val_2.fq,LLMJ2-_ATTACTCG-AGGCGAAG_S220_L005_R2_001_val_2.fq,LLMJ3-_ATTACTCG-TAATCTTA_S219_L005_R2_001_val_2.fq"
bsub -n 8 -R "span[hosts=1]" -q whole_node -M 50 "cufflinks -p 8 --library-type fr-firststrand -o cufflinks_out_gtf_de_novo accepted_hits.bam"
bsub -n 8 -R "span[hosts=1]" -q whole_node -M 50 "cuffcompare -p 8 -r my.gtf.geneid /proj/cmarlab/users/joe/outgroups/rna/fastq_reads/tophat_out_threaded/cufflinks_out_gtf_de_novo/transcripts.gtf"


#COVERAGE ACROSS GENIC REGIONS
java -jar CreateSequenceDictionary.jar R= Cyprinodon_NW.fasta O= Cyprinodon_NW.fasta.dict
java -jar picard.jar AddOrReplaceReadGroups I=CPAE1.rna.sort.bam O=CPAE1.rna.RG.bam  RGLB=lib1 RGPL=illumina RGPU=unit1 RGSM=20
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o coverage.out -I CPAE1.rna.sort.bam -genelist my.gtf.bed" 



bsub -q week "samtools view -Sb CPAE1Aligned.out.sam > CPAE1.rna.bam"
bsub -q week "samtools view -Sb CPAE2Aligned.out.sam > CPAE2.rna.bam"
bsub -q week "samtools view -Sb CPAE3Aligned.out.sam > CPAE3.rna.bam"
bsub -q week "samtools view -Sb CPAJ1Aligned.out.sam > CPAJ1.rna.bam"
bsub -q week "samtools view -Sb CPAJ2Aligned.out.sam > CPAJ2.rna.bam"
bsub -q week "samtools view -Sb CPAJ3Aligned.out.sam > CPAJ3.rna.bam"
bsub -q week "samtools view -Sb CPME1Aligned.out.sam > CPME1.rna.bam"
bsub -q week "samtools view -Sb CPME2Aligned.out.sam > CPME2.rna.bam"
bsub -q week "samtools view -Sb CPME3Aligned.out.sam > CPME3.rna.bam"
bsub -q week "samtools view -Sb CPMJ1Aligned.out.sam > CPMJ1.rna.bam"
bsub -q week "samtools view -Sb CPMJ2Aligned.out.sam > CPMJ2.rna.bam"
bsub -q week "samtools view -Sb CPMJ3Aligned.out.sam > CPMJ3.rna.bam"
bsub -q week "samtools view -Sb CPPE1Aligned.out.sam > CPPE1.rna.bam"
bsub -q week "samtools view -Sb CPPE2Aligned.out.sam > CPPE2.rna.bam"
bsub -q week "samtools view -Sb CPPE3Aligned.out.sam > CPPE3.rna.bam"
bsub -q week "samtools view -Sb CPPJ1Aligned.out.sam > CPPJ1.rna.bam"
bsub -q week "samtools view -Sb CPPJ2Aligned.out.sam > CPPJ2.rna.bam"
bsub -q week "samtools view -Sb LLAE1Aligned.out.sam > LLAE1.rna.bam"
bsub -q week "samtools view -Sb LLAE2Aligned.out.sam > LLAE2.rna.bam"
bsub -q week "samtools view -Sb LLAE3Aligned.out.sam > LLAE3.rna.bam"
bsub -q week "samtools view -Sb LLAJ1Aligned.out.sam > LLAJ1.rna.bam"
bsub -q week "samtools view -Sb LLAJ2Aligned.out.sam > LLAJ2.rna.bam"
bsub -q week "samtools view -Sb LLAJ3Aligned.out.sam > LLAJ3.rna.bam"
bsub -q week "samtools view -Sb LLME1Aligned.out.sam > LLME1.rna.bam"
bsub -q week "samtools view -Sb LLME2Aligned.out.sam > LLME2.rna.bam"
bsub -q week "samtools view -Sb LLME3Aligned.out.sam > LLME3.rna.bam"
bsub -q week "samtools view -Sb LLMJ1Aligned.out.sam > LLMJ1.rna.bam"
bsub -q week "samtools view -Sb LLMJ2Aligned.out.sam > LLMJ2.rna.bam"
bsub -q week "samtools view -Sb LLMJ3Aligned.out.sam > LLMJ3.rna.bam"


bsub -q week "samtools sort CPAE1.rna.bam -o CPAE1.rna.sort.bam"
bsub -q week "samtools sort CPAE2.rna.bam -o CPAE2.rna.sort.bam"
bsub -q week "samtools sort CPAE3.rna.bam -o CPAE3.rna.sort.bam"
bsub -q week "samtools sort CPAJ1.rna.bam -o CPAJ1.rna.sort.bam"
bsub -q week "samtools sort CPAJ2.rna.bam -o CPAJ2.rna.sort.bam"
bsub -q week "samtools sort CPAJ3.rna.bam -o CPAJ3.rna.sort.bam"
bsub -q week "samtools sort CPME1.rna.bam -o CPME1.rna.sort.bam"
bsub -q week "samtools sort CPME2.rna.bam -o CPME2.rna.sort.bam"
bsub -q week "samtools sort CPME3.rna.bam -o CPME3.rna.sort.bam"
bsub -q week "samtools sort CPMJ1.rna.bam -o CPMJ1.rna.sort.bam"
bsub -q week "samtools sort CPMJ2.rna.bam -o CPMJ2.rna.sort.bam"
bsub -q week "samtools sort CPMJ3.rna.bam -o CPMJ3.rna.sort.bam"
bsub -q week "samtools sort CPPE1.rna.bam -o CPPE1.rna.sort.bam"
bsub -q week "samtools sort CPPE2.rna.bam -o CPPE2.rna.sort.bam"
bsub -q week "samtools sort CPPE3.rna.bam -o CPPE3.rna.sort.bam"
bsub -q week "samtools sort CPPJ1.rna.bam -o CPPJ1.rna.sort.bam"
bsub -q week "samtools sort CPPJ2.rna.bam -o CPPJ2.rna.sort.bam"
bsub -q week "samtools sort LLAE1.rna.bam -o LLAE1.rna.sort.bam"
bsub -q week "samtools sort LLAE2.rna.bam -o LLAE2.rna.sort.bam"
bsub -q week "samtools sort LLAE3.rna.bam -o LLAE3.rna.sort.bam"
bsub -q week "samtools sort LLAJ1.rna.bam -o LLAJ1.rna.sort.bam"
bsub -q week "samtools sort LLAJ2.rna.bam -o LLAJ2.rna.sort.bam"
bsub -q week "samtools sort LLAJ3.rna.bam -o LLAJ3.rna.sort.bam"
bsub -q week "samtools sort LLME1.rna.bam -o LLME1.rna.sort.bam"
bsub -q week "samtools sort LLME2.rna.bam -o LLME2.rna.sort.bam"
bsub -q week "samtools sort LLME3.rna.bam -o LLME3.rna.sort.bam"
bsub -q week "samtools sort LLMJ1.rna.bam -o LLMJ1.rna.sort.bam"
bsub -q week "samtools sort LLMJ2.rna.bam -o LLMJ2.rna.sort.bam"
bsub -q week "samtools sort LLMJ3.rna.bam -o LLMJ3.rna.sort.bam"


bsub -q week "samtools index CPAE1.rna.sort.bam"
bsub -q week "samtools index CPAE2.rna.sort.bam"
bsub -q week "samtools index CPAE3.rna.sort.bam"
bsub -q week "samtools index CPAJ1.rna.sort.bam"
bsub -q week "samtools index CPAJ2.rna.sort.bam"
bsub -q week "samtools index CPAJ3.rna.sort.bam"
bsub -q week "samtools index CPME1.rna.sort.bam"
bsub -q week "samtools index CPME2.rna.sort.bam"
bsub -q week "samtools index CPME3.rna.sort.bam"
bsub -q week "samtools index CPMJ1.rna.sort.bam"
bsub -q week "samtools index CPMJ2.rna.sort.bam"
bsub -q week "samtools index CPMJ3.rna.sort.bam"
bsub -q week "samtools index CPPE1.rna.sort.bam"
bsub -q week "samtools index CPPE2.rna.sort.bam"
bsub -q week "samtools index CPPE3.rna.sort.bam"
bsub -q week "samtools index CPPJ1.rna.sort.bam"
bsub -q week "samtools index CPPJ2.rna.sort.bam"
bsub -q week "samtools index LLAE1.rna.sort.bam"
bsub -q week "samtools index LLAE2.rna.sort.bam"
bsub -q week "samtools index LLAE3.rna.sort.bam"
bsub -q week "samtools index LLAJ1.rna.sort.bam"
bsub -q week "samtools index LLAJ2.rna.sort.bam"
bsub -q week "samtools index LLAJ3.rna.sort.bam"
bsub -q week "samtools index LLME1.rna.sort.bam"
bsub -q week "samtools index LLME2.rna.sort.bam"
bsub -q week "samtools index LLME3.rna.sort.bam"
bsub -q week "samtools index LLMJ1.rna.sort.bam"
bsub -q week "samtools index LLMJ2.rna.sort.bam"
bsub -q week "samtools index LLMJ3.rna.sort.bam"


samtools depth ./aligned_sams/$filename.sort.bam | awk '{sum+=$3} END { print "Average = ",sum/NR}' > $filename.depth

bsub -q week "samtools depth -r my.gft.bed CPAE1.rna.sort.bam > CPAE1.rna.depth" 
bsub -q week "samtools depth -r my.gft.bed CPAE2.rna.sort.bam > CPAE2.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPAE3.rna.sort.bam > CPAE3.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPAJ1.rna.sort.bam > CPAJ1.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPAJ2.rna.sort.bam > CPAJ2.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPAJ3.rna.sort.bam > CPAJ3.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPME1.rna.sort.bam > CPME1.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPME2.rna.sort.bam > CPME2.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPME3.rna.sort.bam > CPME3.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPMJ1.rna.sort.bam > CPMJ1.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPMJ2.rna.sort.bam > CPMJ2.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPMJ3.rna.sort.bam > CPMJ3.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPPE1.rna.sort.bam > CPPE1.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPPE2.rna.sort.bam > CPPE2.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPPE3.rna.sort.bam > CPPE3.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPPJ1.rna.sort.bam > CPPJ1.rna.depth"
bsub -q week "samtools depth -r my.gft.bed CPPJ2.rna.sort.bam > CPPJ2.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLAE1.rna.sort.bam > LLAE1.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLAE2.rna.sort.bam > LLAE2.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLAE3.rna.sort.bam > LLAE3.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLAJ1.rna.sort.bam > LLAJ1.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLAJ2.rna.sort.bam > LLAJ2.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLAJ3.rna.sort.bam > LLAJ3.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLME1.rna.sort.bam > LLME1.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLME2.rna.sort.bam > LLME2.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLME3.rna.sort.bam > LLME3.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLMJ1.rna.sort.bam > LLMJ1.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLMJ2.rna.sort.bam > LLMJ2.rna.depth"
bsub -q week "samtools depth -r my.gft.bed LLMJ3.rna.sort.bam > LLMJ3.rna.depth"

awk '{sum+=$13} END { print "Average = ",sum/NR}' test_cov
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPAE2.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPAE3.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPAJ1.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPAJ2.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPAJ3.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPME1.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPME2.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPME3.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPMJ1.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPMJ2.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPMJ3.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPPE1.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPPE2.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPPE3.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPPJ1.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' CPPJ2.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLAE1.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLAE2.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLAE3.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLAJ1.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLAJ2.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLAJ3.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLME1.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLME2.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLME3.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLMJ1.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLMJ2.rna.depth
awk '{sum+=$3} END { print "Average = ",sum/NR}' LLMJ3.rna.depth

bedtools coverage -abam CPAE1.rna.sort.bam -b my.gtf.bed -o test_cov

for file in ./sorted/*.bam
do
filename=$(basename $file .sort.bam)
echo "mark duplicates with Picard in" $file 
java -jar picard.jar MarkDuplicates INPUT=$file OUTPUT=$file.dedup.bam METRICS_FILE=metrics.txt
echo "indexing dedupped bam file:" $file   
java -jar picard.jar BuildBamIndex INPUT=$file.dedup.bam 



bsub -q week "samtools index CPAE1.rna.RG.bam"
bsub -q week "samtools index CPAE2.rna.RG.bam"
bsub -q week "samtools index CPAE3.rna.RG.bam"
bsub -q week "samtools index CPAJ1.rna.RG.bam"
bsub -q week "samtools index CPAJ2.rna.RG.bam"
bsub -q week "samtools index CPAJ3.rna.RG.bam"
bsub -q week "samtools index CPME1.rna.RG.bam"
bsub -q week "samtools index CPME2.rna.RG.bam"
bsub -q week "samtools index CPME3.rna.RG.bam"
bsub -q week "samtools index CPMJ1.rna.RG.bam"
bsub -q week "samtools index CPMJ2.rna.RG.bam"
bsub -q week "samtools index CPMJ3.rna.RG.bam"
bsub -q week "samtools index CPPE1.rna.RG.bam"
bsub -q week "samtools index CPPE2.rna.RG.bam"
bsub -q week "samtools index CPPE3.rna.RG.bam"
bsub -q week "samtools index CPPJ1.rna.RG.bam"
bsub -q week "samtools index CPPJ2.rna.RG.bam"
bsub -q week "samtools index LLAE1.rna.RG.bam"
bsub -q week "samtools index LLAE2.rna.RG.bam"
bsub -q week "samtools index LLAE3.rna.RG.bam"
bsub -q week "samtools index LLAJ1.rna.RG.bam"
bsub -q week "samtools index LLAJ2.rna.RG.bam"
bsub -q week "samtools index LLAJ3.rna.RG.bam"
bsub -q week "samtools index LLME1.rna.RG.bam"
bsub -q week "samtools index LLME2.rna.RG.bam"
bsub -q week "samtools index LLME3.rna.RG.bam"
bsub -q week "samtools index LLMJ1.rna.RG.bam"
bsub -q week "samtools index LLMJ2.rna.RG.bam"
bsub -q week "samtools index LLMJ3.rna.RG.bam"



bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPAE1.rna.RG.depth -I CPAE1.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPAE2.rna.RG.depth -I CPAE2.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPAE3.rna.RG.depth -I CPAE3.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPAJ1.rna.RG.depth -I CPAJ1.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPAJ2.rna.RG.depth -I CPAJ2.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPAJ3.rna.RG.depth -I CPAJ3.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPME1.rna.RG.depth -I CPME1.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPME2.rna.RG.depth -I CPME2.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPME3.rna.RG.depth -I CPME3.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPMJ1.rna.RG.depth -I CPMJ1.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPMJ2.rna.RG.depth -I CPMJ2.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPMJ3.rna.RG.depth -I CPMJ3.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPPE1.rna.RG.depth -I CPPE1.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPPE2.rna.RG.depth -I CPPE2.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPPE3.rna.RG.depth -I CPPE3.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPPJ1.rna.RG.depth -I CPPJ1.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o CPPJ2.rna.RG.depth -I CPPJ2.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLAE1.rna.RG.depth -I LLAE1.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLAE2.rna.RG.depth -I LLAE2.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLAE3.rna.RG.depth -I LLAE3.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLAJ1.rna.RG.depth -I LLAJ1.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLAJ2.rna.RG.depth -I LLAJ2.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLAJ3.rna.RG.depth -I LLAJ3.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLME1.rna.RG.depth -I LLME1.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLME2.rna.RG.depth -I LLME2.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLME3.rna.RG.depth -I LLME3.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLMJ1.rna.RG.depth -I LLMJ1.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLMJ2.rna.RG.depth -I LLMJ2.rna.RG.bam -geneList my.gtf.bed" 
bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T DepthOfCoverage -R Cyprinodon_NW.fasta -o LLMJ3.rna.RG.depth -I LLMJ3.rna.RG.bam -geneList my.gtf.bed" 






#!/bin/bash
wc -l LLAJ2-2nd_Prep_ATTACTCG-ATAGAGGC_S226_L005_R1_001.fastq
wc -l LLAJ2-2nd_Prep_ATTACTCG-ATAGAGGC_S226_L005_R2_001.fastq
wc -l CPMJ1-2nd_Prep_CGCTCATT-AGGCGAAG_S238_L005_R1_001.fastq
wc -l CPMJ1-2nd_Prep_CGCTCATT-AGGCGAAG_S238_L005_R2_001.fastq
wc -l CPAJ3-2nd_Prep_CGCTCATT-GGCTCTGA_S242_L005_R1_001.fastq
wc -l CPAJ3-2nd_Prep_CGCTCATT-GGCTCTGA_S242_L005_R2_001.fastq
wc -l CPAJ1-2nd_Prep_CGCTCATT-ATAGAGGC_S244_L005_R1_001.fastq
wc -l CPAJ1-2nd_Prep_CGCTCATT-ATAGAGGC_S244_L005_R2_001.fastq
wc -l CPAE1-2nd_Prep_CGCTCATT-GTACTGAC_S217_L005_R1_001.fastq
wc -l CPAE1-2nd_Prep_CGCTCATT-GTACTGAC_S217_L005_R2_001.fastq
wc -l CPAE2-_GAGATTCC-TATAGCCT_S218_L005_R1_001.fastq
wc -l CPAE2-_GAGATTCC-TATAGCCT_S218_L005_R2_001.fastq
wc -l CPAE3-_GAGATTCC-ATAGAGGC_S245_L005_R1_001.fastq
wc -l CPAE3-_GAGATTCC-ATAGAGGC_S245_L005_R2_001.fastq
wc -l CPAJ2-_CGCTCATT-CCTATCCT_S243_L005_R1_001.fastq
wc -l CPAJ2-_CGCTCATT-CCTATCCT_S243_L005_R2_001.fastq
wc -l CPME1-_GAGATTCC-CCTATCCT_S241_L005_R1_001.fastq
wc -l CPME1-_GAGATTCC-CCTATCCT_S241_L005_R2_001.fastq
wc -l CPME2-_GAGATTCC-GGCTCTGA_S240_L005_R1_001.fastq
wc -l CPME2-_GAGATTCC-GGCTCTGA_S240_L005_R2_001.fastq
wc -l CPME3-_GAGATTCC-AGGCGAAG_S239_L005_R1_001.fastq
wc -l CPME3-_GAGATTCC-AGGCGAAG_S239_L005_R2_001.fastq
wc -l CPMJ2-_CGCTCATT-TAATCTTA_S237_L005_R1_001.fastq
wc -l CPMJ2-_CGCTCATT-TAATCTTA_S237_L005_R2_001.fastq
wc -l CPMJ3-_CGCTCATT-CAGGACGT_S236_L005_R1_001.fastq
wc -l CPMJ3-_CGCTCATT-CAGGACGT_S236_L005_R2_001.fastq
wc -l CPPE1-_TCCGGAGA-CAGGACGT_S235_L005_R1_001.fastq
wc -l CPPE1-_TCCGGAGA-CAGGACGT_S235_L005_R2_001.fastq
wc -l CPPE2-_TCCGGAGA-GTACTGAC_S234_L005_R1_001.fastq
wc -l CPPE2-_TCCGGAGA-GTACTGAC_S234_L005_R2_001.fastq
wc -l CPPE3-_CGCTCATT-TATAGCCT_S233_L005_R1_001.fastq
wc -l CPPE3-_CGCTCATT-TATAGCCT_S233_L005_R2_001.fastq
wc -l CPPJ1-_TCCGGAGA-AGGCGAAG_S232_L005_R1_001.fastq
wc -l CPPJ1-_TCCGGAGA-AGGCGAAG_S232_L005_R2_001.fastq
wc -l CPPJ2-_TCCGGAGA-TAATCTTA_S231_L005_R1_001.fastq
wc -l CPPJ2-_TCCGGAGA-TAATCTTA_S231_L005_R2_001.fastq
wc -l LLAE1-_ATTACTCG-CAGGACGT_S230_L005_R1_001.fastq
wc -l LLAE1-_ATTACTCG-CAGGACGT_S230_L005_R2_001.fastq
wc -l LLAE2-_ATTACTCG-GTACTGAC_S229_L005_R1_001.fastq
wc -l LLAE2-_ATTACTCG-GTACTGAC_S229_L005_R2_001.fastq
wc -l LLAE3-_TCCGGAGA-TATAGCCT_S228_L005_R1_001.fastq
wc -l LLAE3-_TCCGGAGA-TATAGCCT_S228_L005_R2_001.fastq
wc -l LLAJ1-_ATTACTCG-TATAGCCT_S227_L005_R1_001.fastq
wc -l LLAJ1-_ATTACTCG-TATAGCCT_S227_L005_R2_001.fastq
wc -l LLAJ3-_ATTACTCG-CCTATCCT_S225_L005_R1_001.fastq
wc -l LLAJ3-_ATTACTCG-CCTATCCT_S225_L005_R2_001.fastq
wc -l LLME1-_TCCGGAGA-ATAGAGGC_S224_L005_R1_001.fastq
wc -l LLME1-_TCCGGAGA-ATAGAGGC_S224_L005_R2_001.fastq
wc -l LLME2-_TCCGGAGA-CCTATCCT_S223_L005_R1_001.fastq
wc -l LLME2-_TCCGGAGA-CCTATCCT_S223_L005_R2_001.fastq
wc -l LLME3-_TCCGGAGA-GGCTCTGA_S222_L005_R1_001.fastq
wc -l LLME3-_TCCGGAGA-GGCTCTGA_S222_L005_R2_001.fastq
wc -l LLMJ1-_ATTACTCG-GGCTCTGA_S221_L005_R1_001.fastq
wc -l LLMJ1-_ATTACTCG-GGCTCTGA_S221_L005_R2_001.fastq
wc -l LLMJ2-_ATTACTCG-AGGCGAAG_S220_L005_R1_001.fastq
wc -l LLMJ2-_ATTACTCG-AGGCGAAG_S220_L005_R2_001.fastq
wc -l LLMJ3-_ATTACTCG-TAATCTTA_S219_L005_R1_001.fastq
wc -l LLMJ3-_ATTACTCG-TAATCTTA_S219_L005_R2_001.fastq


awk '{print $3}' axp_jaw_.8_overlap.csv  > axp_jaw_geneid
awk '{print $4}' axp_jaw_.8_overlap.csv  > axp_jaw_ps
awk '{print $3}' axp_embryo_.8_overlap.csv  > axp_embryo_geneid
awk '{print $4}' axp_embryo_.8_overlap.csv  > axp_embryo_ps
paste -d: axp_embryo_geneid axp_embryo_ps > axp_em_tag
paste -d: axp_jaw_geneid axp_jaw_ps > axp_jaw_tag
paste axp_jaw_.8_overlap.csv axp_jaw_tag > axp_jaw
paste axp_embryo_.8_overlap.csv axp_em_tag > axp_embryo





bsub -q week -M 50 "samtools merge cDNA_pupfish_29_8to15dpf_F0_6_8dpf_axmF1.bam axmE1.sort.dedup.RG.split.bam axmE2.sort.dedup.RG.split.bam axmJ1.sort.dedup.RG.split.bam axmJ4.sort.dedup.RG.split.bam axmJ5.sort.dedup.RG.split.bam axmJ6.sort.dedup.RG.split.bam CPAE1.sort.dedup.RG.split.bam CPAE2.sort.dedup.RG.split.bam CPAE3.sort.dedup.RG.split.bam CPAJ1.sort.dedup.RG.split.bam CPAJ2.sort.dedup.RG.split.bam CPAJ3.sort.dedup.RG.split.bam CPME1.sort.dedup.RG.split.bam CPME2.sort.dedup.RG.split.bam CPME3.sort.dedup.RG.split.bam CPMJ1.sort.dedup.RG.split.bam CPMJ2.sort.dedup.RG.split.bam CPMJ3.sort.dedup.RG.split.bam CPPE1.sort.dedup.RG.split.bam CPPE2.sort.dedup.RG.split.bam CPPE3.sort.dedup.RG.split.bam CPPJ1.sort.dedup.RG.split.bam CPPJ2.sort.dedup.RG.split.bam LLAE1.sort.dedup.RG.split.bam LLAE2.sort.dedup.RG.split.bam LLAE3.sort.dedup.RG.split.bam LLAJ1.sort.dedup.RG.split.bam LLAJ2.sort.dedup.RG.split.bam LLAJ3.sort.dedup.RG.split.bam LLME1.sort.dedup.RG.split.bam LLME2.sort.dedup.RG.split.bam LLME3.sort.dedup.RG.split.bam LLMJ1.sort.dedup.RG.split.bam LLMJ2.sort.dedup.RG.split.bam LLMJ3.sort.dedup.RG.split.bam"
bsub -n 8 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -drf DuplicateRead -R /proj/cmarlab/users/joe/axm_rna/tmp/Cyprinodon_NW.fasta -I cDNA_pupfish_29_8to15dpf_F0_6_8dpf_axmF1.bam  -dontUseSoftClippedBases -stand_call_conf 20.0 -nct 8 -o ./variants/cDNA_pupfish_29_8to15dpf_F0_6_8dpf_axmF1_raw_variants.g.vcf"



bsub -M 50 -q week "java -Xmx50g -jar GenomeAnalysisTK.jar -T GenotypeGVCFs -R /proj/cmarlab/users/joe/axm_rna/tmp/Cyprinodon_NW.fasta \
--variant axmE1_raw_variants.g.vcf \
--variant axmE2_raw_variants.g.vcf \
--variant axmJ1_raw_variants.g.vcf \
--variant axmJ4_raw_variants.g.vcf \
--variant axmJ5_raw_variants.g.vcf \
--variant axmJ6_raw_variants.g.vcf \
--variant CPAE1_raw_variants.g.vcf \
--variant CPAE2_raw_variants.g.vcf \
--variant CPAE3_raw_variants.g.vcf \
--variant CPAJ1_raw_variants.g.vcf \
--variant CPAJ2_raw_variants.g.vcf \
--variant CPAJ3_raw_variants.g.vcf \
--variant CPME1_raw_variants.g.vcf \
--variant CPME2_raw_variants.g.vcf \
--variant CPME3_raw_variants.g.vcf \
--variant CPMJ1_raw_variants.g.vcf \
--variant CPMJ2_raw_variants.g.vcf \
--variant CPMJ3_raw_variants.g.vcf \
--variant CPPE1_raw_variants.g.vcf \
--variant CPPE2_raw_variants.g.vcf \
--variant CPPE3_raw_variants.g.vcf \
--variant CPPJ1_raw_variants.g.vcf \
--variant CPPJ2_raw_variants.g.vcf \
--variant LLAE1_raw_variants.g.vcf \
--variant LLAE2_raw_variants.g.vcf \
--variant LLAE3_raw_variants.g.vcf \
--variant LLAJ1_raw_variants.g.vcf \
--variant LLAJ2_raw_variants.g.vcf \
--variant LLAJ3_raw_variants.g.vcf \
--variant LLME1_raw_variants.g.vcf \
--variant LLME2_raw_variants.g.vcf \
--variant LLME3_raw_variants.g.vcf \
--variant LLMJ1_raw_variants.g.vcf \
--variant LLMJ2_raw_variants.g.vcf \
--variant LLMJ3_raw_variants.g.vcf \
-o cDNA_pupfish_29_8to15dpf_F0_6_8dpf_axmF1.vcf"

