#### ALL COMBINED ####

bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I CRPA1.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/CRPA1_raw_variants.g.vcf" 
bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I CRPM1.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/CRPM1_raw_variants.g.vcf" 
bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I CRPPQ.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/CRPPQ_raw_variants.g.vcf" 
bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I LILA1.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/LILA1_raw_variants.g.vcf" 
bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I LILMQ.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/LILMQ_raw_variants.g.vcf" 
bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I LILPQ.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/LILPQ_raw_variants.g.vcf" 
bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I ME2A1.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/ME2A1_raw_variants.g.vcf" 
bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I OSPA1.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/OSPA1_raw_variants.g.vcf" 
bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I OSPM1.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/OSPM1_raw_variants.g.vcf" 
bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I OSPP1.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/OSPP1_raw_variants.g.vcf" 
bsub -n 4 -R "span[hosts=1]" -q whole_node "java -Xmx10g -jar GenomeAnalysisTK.jar -T HaplotypeCaller -R Cyprinodon.fasta -I DIA54918.dedup.bam --genotyping_mode DISCOVERY --emitRefConfidence GVCF -mmq 5 -nct 4 -o ./variants/DIA54918_raw_variants.g.vcf" 

############### COMBINE
#!/bin/bash

java -Xmx10g -jar GenomeAnalysisTK.jar -T GenotypeGVCFs -R Cyprinodon.fasta \
--variant ./variants/CRPA1_raw_variants.g.vcf \
--variant ./variants/CRPA3_raw_variants.g.vcf \
--variant ./variants/CRPM1_raw_variants.g.vcf \
--variant ./variants/CRPM3_raw_variants.g.vcf \
--variant ./variants/CRPP2_raw_variants.g.vcf \
--variant ./variants/CRPP3_raw_variants.g.vcf \
--variant ./variants/CRPPQ_raw_variants.g.vcf \
--variant ./variants/CUNA1_raw_variants.g.vcf \
--variant ./variants/GREA1_raw_variants.g.vcf \
--variant ./variants/GREA2_raw_variants.g.vcf \
--variant ./variants/GREP1_raw_variants.g.vcf \
--variant ./variants/GREP2_raw_variants.g.vcf \
--variant ./variants/LILA1_raw_variants.g.vcf \
--variant ./variants/LILM3_raw_variants.g.vcf \
--variant ./variants/LILM4_raw_variants.g.vcf \
--variant ./variants/LILMQ_raw_variants.g.vcf \
--variant ./variants/LILP3_raw_variants.g.vcf \
--variant ./variants/LILP4_raw_variants.g.vcf \
--variant ./variants/LILPQ_raw_variants.g.vcf \
--variant ./variants/ME2A1_raw_variants.g.vcf \
--variant ./variants/ME2A2_raw_variants.g.vcf \
--variant ./variants/ME2P1_raw_variants.g.vcf \
--variant ./variants/MERA2_raw_variants.g.vcf \
--variant ./variants/MERA3_raw_variants.g.vcf \
--variant ./variants/MRKA1_raw_variants.g.vcf \
--variant ./variants/MRKM1_raw_variants.g.vcf \
--variant ./variants/MRKM2_raw_variants.g.vcf \
--variant ./variants/OSPA1_raw_variants.g.vcf \
--variant ./variants/OSPM1_raw_variants.g.vcf \
--variant ./variants/OSPM2_raw_variants.g.vcf \
--variant ./variants/OSPM3_raw_variants.g.vcf \
--variant ./variants/OSPP1_raw_variants.g.vcf \
--variant ./variants/OSPP2_raw_variants.g.vcf \
--variant ./variants/OSPP3_raw_variants.g.vcf \
--variant ./variants/OYSP1_raw_variants.g.vcf \
--variant ./variants/OYSP3_raw_variants.g.vcf \
--variant ./variants/PIGA1_raw_variants.g.vcf \
--variant ./variants/PIGA2_raw_variants.g.vcf \
-o recombined.vcf

FIND RAW SNPS
bsub -q week "java -jar GenomeAnalysisTK.jar -T SelectVariants \ -R Cyprinodon.fasta \ -V recombined.vcf \ -selectType SNP \ -o recombined_raw_snps.vcf" 

HARD FILTER SNPS
bsub -q week java -jar GenomeAnalysisTK.jar -T VariantFiltration -R Cyprinodon.fasta -V recombined_raw_snps.vcf --filterExpression "QD < 2.0 || FS > 60.0 || MQ < 40.0 || MQRankSum < -12.5 || ReadPosRankSum < -8.0" --filterName "my_snp_filter" -o recombined_filtered_snps.vcf 

FIND RAW INDELS
bsub -q week "java -jar GenomeAnalysisTK.jar -T SelectVariants -R Cyprinodon.fasta -V recombined.vcf -selectType INDEL -o recombined_raw_indels.vcf" 

HARD FILTER INDELS
bsub -q week java -jar GenomeAnalysisTK.jar -T VariantFiltration -R Cyprinodon.fasta -V recombined_raw_indels.vcf --filterExpression "QD < 2.0 || FS > 200.0 || ReadPosRankSum < -20.0" --filterName "my_indel_filter" -o recombined_filtered_indels.vcf

ZIP
bsub -q week "bgzip recombined_filtered_snps.vcf"
bsub -q week "tabix -p vcf recombined_filtered_snps.vcf.gz"

STATS
bsub -q week "vcf-stats recombined_filtered_snps.vcf.gz"
bsub -q week "vcftools --vcf filtered_snps.vcf --depth"
bsub -q week "vcftools --vcf filtered_snps.vcf --site-mean-depth"

PLINK
bsub -q week "vcftools --gzvcf recombined_filtered_snps.vcf.gz --plink --out filtered_snps"


	FILTER #filtered_snps.ped/map
	bsub -q week "./plink.exe --file recombined_filtered_snps.vcf.gz --geno 0.1 --maf 0.05 --allow-extra-chr --recode"
	
	FILTER #filtered_snps.vcf
	bsub -q week "vcftools --gzvcf recombined_filtered_snps.vcf.gz --maf 0.05 --max-missing 0.9 --recode --out filtered_snps"

MAKE BED
bsub -q week "./plink.exe --file filtered_snps --pheno up_jaw_pheno.txt --allow-extra-chr --make-bed --out filtered_snps"
bsub -q week "./plink.exe --file pruned_plink --pheno up_jaw_pheno.txt --allow-extra-chr --make-bed --out filtered_snps"

GEMMA
bsub -q week -M 20 "./gemma.exe -bfile filtered_snps -w 50000000 -s 100000000 -rpace 10000 -wpace 100000 -bslmm 1 -o gemma_up_jaw_recombined"
bsub -q week -M 20 "./gemma.exe -bfile pruned_plink -w 50000000 -s 100000000 -rpace 10000 -wpace 100000 -bslmm 1 -maf 0.05 -miss 0.1 -snps gemma_snps.txt -o gemma_up_jaw_snplist1"

SPLIT POPULATIONS
bsub -q week "vcftools --vcf filtered_snps.vcf --keep a_indivs.txt --recode --out a_snps.vcf"
bsub -q week "vcftools --vcf filtered_snps.vcf --keep m_indivs.txt --recode --out m_snps.vcf"
bsub -q week "vcftools --vcf filtered_snps.vcf --keep p_indivs.txt --recode --out p_snps.vcf"

LD BASED SNP PRUNING #snps in LD (>.5 r^2) 
bsub -q week "./plink.exe --file filtered_snps --ld-window-r2 0.5 --r2" #creates plink.ld 
bsub -q week "./plink.exe --file filtered_snps --exclude plink.ld --allow-extra-chr --recode --out pruned_plink"
bsub -q week "./plink.exe --file pruned_plink --thin .2 --allow-extra-chr --recode --out thin_plink"
bsub -q week "./plink.exe --file thin_plink --pheno up_jaw_pheno.txt --allow-extra-chr --make-bed --out thin_plink"
  
GEMMA
bsub -q week -M 20 "./gemma.exe -bfile thin_plink -w 50000000 -s 100000000 -rpace 10000 -wpace 100000 -bslmm 1 -o gemma_up_jaw_thin"

	
	# Separate association for am and ap
	bsub -q week "./plink.exe --file pruned_plink --keep axp.txt --allow-extra-chr --recode --out pruned_ap"
	bsub -q week "./plink.exe --file pruned_plink --keep axm.txt --allow-extra-chr --recode --out pruned_am"
	
	bsub -q week "./plink.exe --file pruned_ap --pheno up_jaw_pheno.txt --allow-extra-chr --make-bed --out pruned_ap"
	bsub -q week "./plink.exe --file pruned_am --pheno up_jaw_pheno.txt --allow-extra-chr --make-bed --out pruned_am"

	bsub -q week -M 20 "./gemma.exe -bfile pruned_am -w 50000000 -s 100000000 -rpace 10000 -wpace 100000 -bslmm 1 -o gemma_up_jaw_am1"
	bsub -q week -M 20 "./gemma.exe -bfile pruned_ap -w 50000000 -s 100000000 -rpace 10000 -wpace 100000 -bslmm 1 -o gemma_up_jaw_ap1"


PCA
bsub -q week "./plink.exe --file filtered_snps --allow-extra-chr --pca tabs"

PLINK ASSOCIATION #correct for population structure using pca
bsub -q week "./plink.exe --bfile filtered_snps --allow-extra-chr --allow-no-sex --linear hide-covar --covar eigenvec_re_1.txt --pheno up_jaw_pheno.txt --out up_jaw_1PC"
bsub -q week "./plink.exe --bfile filtered_snps --allow-extra-chr --allow-no-sex --linear hide-covar --covar eigenvec_re_5.txt --pheno pupfish_residuals.txt --all-pheno"

	NO POP CORRECTION
	bsub -q week "./plink.exe --file filtered_snps --pheno up_jaw_pheno.txt --allow-no-sex --allow-extra-chr --assoc --out up_jaw_no_correction"


FST (changed a_indivs file to include CUNA1)
bsub -q week "vcftools --vcf filtered_snps.vcf --keep axm.txt --out axm_fst_genome --weir-fst-pop a_indivs.txt --weir-fst-pop m_indivs.txt"
bsub -q week "vcftools --vcf filtered_snps.vcf --keep axp.txt --out axp_fst_genome --weir-fst-pop a_indivs.txt --weir-fst-pop p_indivs.txt"
bsub -q week "vcftools --vcf filtered_snps.vcf --keep mxp.txt --out mxp_fst_genome --weir-fst-pop m_indivs.txt --weir-fst-pop p_indivs.txt"

bsub -q week "sed '"s/-[0-9].*/0/g"' axm_fst_genome.weir.fst > am_fst"
bsub -q week "sed '"s/-[0-9].*/0/g"' axp_fst_genome.weir.fst > ap_fst"
bsub -q week "sed '"s/-[0-9].*/0/g"' mxp_fst_genome.weir.fst > mp_fst"

Tajima's D
bsub -q week "vcftools --vcf a_snps.vcf --TajimaD 10000 --out taj_d_a"
bsub -q week "vcftools --vcf m_snps.vcf --TajimaD 10000 --out taj_d_m"
bsub -q week "vcftools --vcf p_snps.vcf --TajimaD 10000 --out taj_d_p"​

PI
bsub -q week "vcftools --vcf a_snps.vcf --window-pi 10000 --out a_pi"
bsub -q week "vcftools --vcf m_snps.vcf --window-pi 10000 --out m_pi"
bsub -q week "vcftools --vcf p_snps.vcf --window-pi 10000 --out p_pi"

bsub -q week "vcftools --vcf a_snps.vcf --chr KL653415.1 --chr KL653197.1 --chr KL652786.1 --chr KL652646.1 --chr KL652956.1 --chr KL653661.1 --chr KL653582.1 --chr KL654234.1 --chr KL653002.1 --chr KL652615.1 --chr KL652613.1 --chr KL652512.1 --window-pi 10000 --out a_pi_popbam_test"

DELLY
bsub -q week "delly call -t INV -o m_inversions.bcf -g Cyprinodon.fasta LILM3.dedup.bam CUNA1.dedup.bam" 
bsub -q week "delly call -t INV -o p_inversions.bcf -g Cyprinodon.fasta LILP3.dedup.bam CUNA1.dedup.bam" 


############### DELLY #####################
#DID NOT WORK TO USE ALL POPS
bsub -q week "java -jar picard.jar AddOrReplaceReadGroups I=i_pops_masked.bam O=i_test2_rg.bam RGID=1 RGLB=1 RGPL=1 RGPU=1 RGSM=1"
bsub -q week "java -jar picard.jar AddOrReplaceReadGroups I=o_pops_masked.bam O=o_test2_rg.bam RGID=2 RGLB=2 RGPL=2 RGPU=2 RGSM=2"
bsub -q week "java -jar picard.jar AddOrReplaceReadGroups I=m_pops_masked.bam O=m_test2_rg.bam RGID=3 RGLB=3 RGPL=3 RGPU=3 RGSM=3"
bsub -q week "java -jar picard.jar AddOrReplaceReadGroups I=p_pops_masked.bam O=p_test2_rg.bam RGID=4 RGLB=4 RGPL=4 RGPU=4 RGSM=4"
bsub -q week "java -jar picard.jar AddOrReplaceReadGroups I=genero_pops_masked.bam O=genero_test2_rg.bam RGID=5 RGLB=5 RGPL=5 RGPU=5 RGSM=5"

bsub -q week "samtools index genero_test2_rg.bam"
bsub -q week "samtools index o_test2_rg.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o ixo_del.bcf i_test2_rg.bam o_test2_rg.bam"
delly call -t DEL -g Cyprinodon.fasta -o ixo_interactive_del.bcf i_test2_rg.bam o_test2_rg.bam
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPA1xCRPM1_del.bcf CRPA1.dedup.bam CRPM1.dedup.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPA1xCRPM1_dup.bcf CRPA1.dedup.bam CRPM1.dedup.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPA1xCRPM1_inv.bcf CRPA1.dedup.bam CRPM1.dedup.bam"

bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o mxgenero_del.bcf m_test2_rg.bam genero_test2_rg.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o mxgenero_dup.bcf m_test2_rg.bam genero_test2_rg.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o mxgenero_inv.bcf m_test2_rg.bam genero_test2_rg.bam"
                                                                                                           
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o pxgenero_del.bcf p_test2_rg.bam genero_test2_rg.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o pxgenero_dup.bcf p_test2_rg.bam genero_test2_rg.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o pxgenero_inv.bcf p_test2_rg.bam genero_test2_rg.bam"

bsub -q week "svprops CRPA1xCRPM1_del.bcf > CRPA1xCRPM1_del.stats"
bsub -q week "svprops CRPA1xCRPM1_dup.bcf > CRPA1xCRPM1_dup.stats"
bsub -q week "svprops CRPA1xCRPM1_inv.bcf > CRPA1xCRPM1_inv.stats"

bsub -q week "svprops mxgenero_del.bcf > mxgenero_del.stats"
bsub -q week "svprops mxgenero_dup.bcf > mxgenero_dup.stats"
bsub -q week "svprops mxgenero_inv.bcf > mxgenero_inv.stats"

bsub -q week "svprops pxgenero_del.bcf > pxgenero_del.stats"
bsub -q week "svprops pxgenero_dup.bcf > pxgenero_dup.stats"
bsub -q week "svprops pxgenero_inv.bcf > pxgenero_inv.stats"



## CRPM x CRPA ##
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM1xCRPA1_del.bcf CRPM1_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM1xCRPA1_dup.bcf CRPM1_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM1xCRPA1_inv.bcf CRPM1_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM3xCRPA1_del.bcf CRPM3_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM3xCRPA1_dup.bcf CRPM3_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM3xCRPA1_inv.bcf CRPM3_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM1xCRPA3_del.bcf CRPM1_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM1xCRPA3_dup.bcf CRPM1_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM1xCRPA3_inv.bcf CRPM1_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM3xCRPA3_del.bcf CRPM3_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM3xCRPA3_dup.bcf CRPM3_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM3xCRPA3_inv.bcf CRPM3_masked.bam CRPA3_masked.bam"

## LILM x LILA ##
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o LILM3xLILA1_del.bcf LILM3_masked.bam LILA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o LILM3xLILA1_dup.bcf LILM3_masked.bam LILA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o LILM3xLILA1_inv.bcf LILM3_masked.bam LILA1_masked.bam"

## CRPM x ougroups ##
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM1xCUNA1_del.bcf CRPM1_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM1xCUNA1_dup.bcf CRPM1_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM1xCUNA1_inv.bcf CRPM1_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM3xCUNA1_del.bcf CRPM3_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM3xCUNA1_dup.bcf CRPM3_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM3xCUNA1_inv.bcf CRPM3_masked.bam CUNA1_masked.bam"

bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM1xETA1_del.bcf CRPM1_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM1xETA1_dup.bcf CRPM1_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM1xETA1_inv.bcf CRPM1_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM3xETA1_del.bcf CRPM3_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM3xETA1_dup.bcf CRPM3_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM3xETA1_inv.bcf CRPM3_masked.bam ETA1_masked.bam"

bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM1xDIA54918_del.bcf CRPM1_masked.bam DIA54918_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM1xDIA54918_dup.bcf CRPM1_masked.bam DIA54918_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM1xDIA54918_inv.bcf CRPM1_masked.bam DIA54918_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM3xDIA54918_del.bcf CRPM3_masked.bam DIA54918_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM3xDIA54918_dup.bcf CRPM3_masked.bam DIA54918_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM3xDIA54918_inv.bcf CRPM3_masked.bam DIA54918_masked.bam"

bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM1xSIM1_del.bcf CRPM1_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM1xSIM1_dup.bcf CRPM1_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM1xSIM1_inv.bcf CRPM1_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM3xSIM1_del.bcf CRPM3_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPM3xSIM1_dup.bcf CRPM3_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPM3xSIM1_inv.bcf CRPM3_masked.bam SIM1_masked.bam"




bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPM1xSIM1_del.bcf CRPM1_masked.bam SIM1_masked.bam"

#############################################################
## CRPP x CRPA ##
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPP2xCRPA1_del.bcf CRPP2_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPP2xCRPA1_dup.bcf CRPP2_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPP2xCRPA1_inv.bcf CRPP2_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPP3xCRPA1_del.bcf CRPP3_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPP3xCRPA1_dup.bcf CRPP3_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPP3xCRPA1_inv.bcf CRPP3_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPP2xCRPA3_del.bcf CRPP2_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPP2xCRPA3_dup.bcf CRPP2_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPP2xCRPA3_inv.bcf CRPP2_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPP3xCRPA3_del.bcf CRPP3_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPP3xCRPA3_dup.bcf CRPP3_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPP3xCRPA3_inv.bcf CRPP3_masked.bam CRPA3_masked.bam"

## LILP x LILA ##
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o LILP3xLILA1_del.bcf LILP3_masked.bam LILA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o LILP3xLILA1_dup.bcf LILP3_masked.bam LILA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o LILP3xLILA1_inv.bcf LILP3_masked.bam LILA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o LILP4xLILA1_del.bcf LILP4_masked.bam LILA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o LILP4xLILA1_dup.bcf LILP4_masked.bam LILA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o LILP4xLILA1_inv.bcf LILP4_masked.bam LILA1_masked.bam"

bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o LILP3xCRPA1_del.bcf LILP3_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o LILP3xCRPA1_dup.bcf LILP3_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o LILP3xCRPA1_inv.bcf LILP3_masked.bam CRPA1_masked.bam"

bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o LILP3xCRPA3_del.bcf LILP3_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o LILP3xCRPA3_dup.bcf LILP3_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o LILP3xCRPA3_inv.bcf LILP3_masked.bam CRPA3_masked.bam"

bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o LILP4xCRPA1_del.bcf LILP4_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o LILP4xCRPA1_dup.bcf LILP4_masked.bam CRPA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o LILP4xCRPA1_inv.bcf LILP4_masked.bam CRPA1_masked.bam"

bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o LILP4xCRPA3_del.bcf LILP4_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o LILP4xCRPA3_dup.bcf LILP4_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o LILP4xCRPA3_inv.bcf LILP4_masked.bam CRPA3_masked.bam"

bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPA1xCRPA3_del.bcf CRPA1_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPA1xCRPA3_dup.bcf CRPA1_masked.bam CRPA3_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPA1xCRPA3_inv.bcf CRPA1_masked.bam CRPA3_masked.bam"

bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPA1xETA1_del.bcf CRPA1_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPA1xETA1_dup.bcf CRPA1_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPA1xETA1_inv.bcf CRPA1_masked.bam ETA1_masked.bam"
                                                             
                                                             
## outgroups ##                                              
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPP2xCUNA1_del.bcf CRPP2_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPP2xCUNA1_dup.bcf CRPP2_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPP2xCUNA1_inv.bcf CRPP2_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPP3xCUNA1_del.bcf CRPP3_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPP3xCUNA1_dup.bcf CRPP3_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPP3xCUNA1_inv.bcf CRPP3_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPP2xETA1_del.bcf CRPP2_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPP2xETA1_dup.bcf CRPP2_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPP2xETA1_inv.bcf CRPP2_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPP3xETA1_del.bcf CRPP3_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPP3xETA1_dup.bcf CRPP3_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPP3xETA1_inv.bcf CRPP3_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPP2xSIM1_del.bcf CRPP2_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPP2xSIM1_dup.bcf CRPP2_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPP2xSIM1_inv.bcf CRPP2_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPP3xSIM1_del.bcf CRPP3_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPP3xSIM1_dup.bcf CRPP3_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPP3xSIM1_inv.bcf CRPP3_masked.bam SIM1_masked.bam"

bsub -q week "svprops CRPP2xCRPA1_del.bcf > CRPP2xCRPA1_del.stats"
bsub -q week "svprops CRPP2xCRPA1_dup.bcf > CRPP2xCRPA1_dup.stats"
bsub -q week "svprops CRPP2xCRPA1_inv.bcf > CRPP2xCRPA1_inv.stats"
bsub -q week "svprops CRPP3xCRPA1_del.bcf > CRPP3xCRPA1_del.stats"
bsub -q week "svprops CRPP3xCRPA1_dup.bcf > CRPP3xCRPA1_dup.stats"
bsub -q week "svprops CRPP3xCRPA1_inv.bcf > CRPP3xCRPA1_inv.stats"
bsub -q week "svprops CRPP2xCRPA3_del.bcf > CRPP2xCRPA3_del.stats"
bsub -q week "svprops CRPP2xCRPA3_dup.bcf > CRPP2xCRPA3_dup.stats"
bsub -q week "svprops CRPP2xCRPA3_inv.bcf > CRPP2xCRPA3_inv.stats"
bsub -q week "svprops CRPP3xCRPA3_del.bcf > CRPP3xCRPA3_del.stats"
bsub -q week "svprops CRPP3xCRPA3_dup.bcf > CRPP3xCRPA3_dup.stats"
bsub -q week "svprops CRPP3xCRPA3_inv.bcf > CRPP3xCRPA3_inv.stats"
bsub -q week "svprops LILP3xLILA1_del.bcf > LILP3xLILA1_del.stats"
bsub -q week "svprops LILP3xLILA1_dup.bcf > LILP3xLILA1_dup.stats"
bsub -q week "svprops LILP3xLILA1_inv.bcf > LILP3xLILA1_inv.stats"
bsub -q week "svprops LILP4xLILA1_del.bcf > LILP4xLILA1_del.stats"
bsub -q week "svprops LILP4xLILA1_dup.bcf > LILP4xLILA1_dup.stats"
bsub -q week "svprops LILP4xLILA1_inv.bcf > LILP4xLILA1_inv.stats"
bsub -q week "svprops CRPP2xCUNA1_del.bcf > CRPP2xCUNA1_del.stats"
bsub -q week "svprops CRPP2xCUNA1_dup.bcf > CRPP2xCUNA1_dup.stats"
bsub -q week "svprops CRPP2xCUNA1_inv.bcf > CRPP2xCUNA1_inv.stats"
bsub -q week "svprops CRPP3xCUNA1_del.bcf > CRPP3xCUNA1_del.stats"
bsub -q week "svprops CRPP3xCUNA1_dup.bcf > CRPP3xCUNA1_dup.stats"
bsub -q week "svprops CRPP3xCUNA1_inv.bcf > CRPP3xCUNA1_inv.stats"
bsub -q week "svprops CRPP2xETA1_del.bcf >  CRPP2xETA1_del.stats"
bsub -q week "svprops CRPP2xETA1_dup.bcf >  CRPP2xETA1_dup.stats"
bsub -q week "svprops CRPP2xETA1_inv.bcf >  CRPP2xETA1_inv.stats"
bsub -q week "svprops CRPP3xETA1_del.bcf >  CRPP3xETA1_del.stats"
bsub -q week "svprops CRPP3xETA1_dup.bcf >  CRPP3xETA1_dup.stats"
bsub -q week "svprops CRPP3xETA1_inv.bcf >  CRPP3xETA1_inv.stats"
bsub -q week "svprops CRPP2xSIM1_del.bcf >  CRPP2xSIM1_del.stats"
bsub -q week "svprops CRPP2xSIM1_dup.bcf >  CRPP2xSIM1_dup.stats"
bsub -q week "svprops CRPP2xSIM1_inv.bcf >  CRPP2xSIM1_inv.stats"
bsub -q week "svprops CRPP3xSIM1_del.bcf >  CRPP3xSIM1_del.stats"
bsub -q week "svprops CRPP3xSIM1_dup.bcf >  CRPP3xSIM1_dup.stats"
bsub -q week "svprops CRPP3xSIM1_inv.bcf >  CRPP3xSIM1_inv.stats"


bsub -q week "svprops LILP3xCRPA1_del.bcf > LILP3xCRPA1_del.stats"
bsub -q week "svprops LILP3xCRPA1_dup.bcf > LILP3xCRPA1_dup.stats"
bsub -q week "svprops LILP3xCRPA1_inv.bcf > LILP3xCRPA1_inv.stats"
bsub -q week "svprops LILP3xCRPA3_del.bcf > LILP3xCRPA3_del.stats"
bsub -q week "svprops LILP3xCRPA3_dup.bcf > LILP3xCRPA3_dup.stats"
bsub -q week "svprops LILP3xCRPA3_inv.bcf > LILP3xCRPA3_inv.stats"
bsub -q week "svprops LILP4xCRPA1_del.bcf > LILP4xCRPA1_del.stats"
bsub -q week "svprops LILP4xCRPA1_dup.bcf > LILP4xCRPA1_dup.stats"
bsub -q week "svprops LILP4xCRPA1_inv.bcf > LILP4xCRPA1_inv.stats"
bsub -q week "svprops LILP4xCRPA3_del.bcf > LILP4xCRPA3_del.stats"
bsub -q week "svprops LILP4xCRPA3_dup.bcf > LILP4xCRPA3_dup.stats"
bsub -q week "svprops LILP4xCRPA3_inv.bcf > LILP4xCRPA3_inv.stats"
bsub -q week "svprops CRPA1xCRPA3_del.bcf > CRPA1xCRPA3_del.stats"
bsub -q week "svprops CRPA1xCRPA3_dup.bcf > CRPA1xCRPA3_dup.stats"
bsub -q week "svprops CRPA1xCRPA3_inv.bcf > CRPA1xCRPA3_inv.stats"
bsub -q week "svprops CRPA1xETA1_del.bcf > CRPA1xETA1_del.stats" 
bsub -q week "svprops CRPA1xETA1_dup.bcf > CRPA1xETA1_dup.stats" 
bsub -q week "svprops CRPA1xETA1_inv.bcf > CRPA1xETA1_inv.stats" 



### a x outgroups ###
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPA1xCUNA1_del.bcf CRPA1_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPA1xCUNA1_dup.bcf CRPA1_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPA1xCUNA1_inv.bcf CRPA1_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPA3xCUNA1_del.bcf CRPA3_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPA3xCUNA1_dup.bcf CRPA3_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPA3xCUNA1_inv.bcf CRPA3_masked.bam CUNA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPA1xETA1_del.bcf CRPA1_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPA1xETA1_dup.bcf CRPA1_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPA1xETA1_inv.bcf CRPA1_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPA3xETA1_del.bcf CRPA3_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPA3xETA1_dup.bcf CRPA3_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPA3xETA1_inv.bcf CRPA3_masked.bam ETA1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPA1xSIM1_del.bcf CRPA1_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPA1xSIM1_dup.bcf CRPA1_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPA1xSIM1_inv.bcf CRPA1_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t DEL -g Cyprinodon.fasta -o CRPA3xSIM1_del.bcf CRPA3_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t DUP -g Cyprinodon.fasta -o CRPA3xSIM1_dup.bcf CRPA3_masked.bam SIM1_masked.bam"
bsub -q week "delly call -t INV -g Cyprinodon.fasta -o CRPA3xSIM1_inv.bcf CRPA3_masked.bam SIM1_masked.bam"

